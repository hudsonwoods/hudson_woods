(function(e,t,n){function i(){var t=e.L;r.noConflict=function(){e.L=t;return this};e.L=r}var r={version:"0.8-dev"};if(typeof module==="object"&&typeof module.exports==="object"){module.exports=r}else if(typeof define==="function"&&define.amd){define(r)}else{i()}r.Util={extend:function(e){var t,n,r,i;for(n=1,r=arguments.length;n<r;n++){i=arguments[n];for(t in i){e[t]=i[t]}}return e},create:Object.create||function(){function e(){}return function(t){e.prototype=t;return new e}}(),bind:function(e,t){var n=Array.prototype.slice;if(e.bind){return e.bind.apply(e,n.call(arguments,1))}var r=n.call(arguments,2);return function(){return e.apply(t,r.length?r.concat(n.call(arguments)):arguments)}},stamp:function(e){e._leaflet_id=e._leaflet_id||++r.Util.lastId;return e._leaflet_id},lastId:0,throttle:function(e,t,n){var r,i,s,o;o=function(){r=false;if(i){s.apply(n,i);i=false}};s=function(){if(r){i=arguments}else{e.apply(n,arguments);setTimeout(o,t);r=true}};return s},wrapNum:function(e,t,n){var r=t[1],i=t[0],s=r-i;return e===r&&n?e:((e-i)%s+s)%s+i},falseFn:function(){return false},formatNum:function(e,t){var n=Math.pow(10,t||5);return Math.round(e*n)/n},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},splitWords:function(e){return r.Util.trim(e).split(/\s+/)},setOptions:function(e,t){if(!e.hasOwnProperty("options")){e.options=e.options?r.Util.create(e.options):{}}for(var n in t){e.options[n]=t[n]}return e.options},getParamString:function(e,t,n){var r=[];for(var i in e){r.push(encodeURIComponent(n?i.toUpperCase():i)+"="+encodeURIComponent(e[i]))}return(!t||t.indexOf("?")===-1?"?":"&")+r.join("&")},template:function(e,t){return e.replace(r.Util.templateRe,function(e,r){var i=t[r];if(i===n){throw new Error("No value provided for variable "+e)}else if(typeof i==="function"){i=i(t)}return i})},templateRe:/\{ *([\w_]+) *\}/g,isArray:Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="};(function(){function t(t){return e["webkit"+t]||e["moz"+t]||e["ms"+t]}function i(t){var r=+(new Date),i=Math.max(0,16-(r-n));n=r+i;return e.setTimeout(t,i)}var n=0;var s=e.requestAnimationFrame||t("RequestAnimationFrame")||i,o=e.cancelAnimationFrame||t("CancelAnimationFrame")||t("CancelRequestAnimationFrame")||function(t){e.clearTimeout(t)};r.Util.requestAnimFrame=function(t,n,o){if(o&&s===i){t.call(n)}else{return s.call(e,r.bind(t,n))}};r.Util.cancelAnimFrame=function(t){if(t){o.call(e,t)}}})();r.extend=r.Util.extend;r.bind=r.Util.bind;r.stamp=r.Util.stamp;r.setOptions=r.Util.setOptions;r.Class=function(){};r.Class.extend=function(e){var t=function(){if(this.initialize){this.initialize.apply(this,arguments)}if(this._initHooks.length){this.callInitHooks()}};var n=t.__super__=this.prototype;var i=r.Util.create(n);i.constructor=t;t.prototype=i;for(var s in this){if(this.hasOwnProperty(s)&&s!=="prototype"){t[s]=this[s]}}if(e.statics){r.extend(t,e.statics);delete e.statics}if(e.includes){r.Util.extend.apply(null,[i].concat(e.includes));delete e.includes}if(i.options){e.options=r.Util.extend(r.Util.create(i.options),e.options)}r.extend(i,e);i._initHooks=[];i.callInitHooks=function(){if(this._initHooksCalled){return}if(n.callInitHooks){n.callInitHooks.call(this)}this._initHooksCalled=true;for(var e=0,t=i._initHooks.length;e<t;e++){i._initHooks[e].call(this)}};return t};r.Class.include=function(e){r.extend(this.prototype,e)};r.Class.mergeOptions=function(e){r.extend(this.prototype.options,e)};r.Class.addInitHook=function(e){var t=Array.prototype.slice.call(arguments,1);var n=typeof e==="function"?e:function(){this[e].apply(this,t)};this.prototype._initHooks=this.prototype._initHooks||[];this.prototype._initHooks.push(n)};r.Evented=r.Class.extend({on:function(e,t,n){if(typeof e==="object"){for(var i in e){this._on(i,e[i],t)}}else{e=r.Util.splitWords(e);for(var s=0,o=e.length;s<o;s++){this._on(e[s],t,n)}}return this},off:function(e,t,n){if(!e){delete this._events}else if(typeof e==="object"){for(var i in e){this._off(i,e[i],t)}}else{e=r.Util.splitWords(e);for(var s=0,o=e.length;s<o;s++){this._off(e[s],t,n)}}return this},_on:function(e,t,n){var i=this._events=this._events||{},s=n&&n!==this&&r.stamp(n);if(s){var o=e+"_idx",u=e+"_len",a=i[o]=i[o]||{},f=r.stamp(t)+"_"+s;if(!a[f]){a[f]={fn:t,ctx:n};i[u]=(i[u]||0)+1}}else{i[e]=i[e]||[];i[e].push({fn:t})}},_off:function(e,t,n){var i=this._events,s=e+"_idx",o=e+"_len";if(!i){return}if(!t){delete i[e];delete i[s];delete i[o];return}var u=n&&n!==this&&r.stamp(n),a,f,l,c,h;if(u){h=r.stamp(t)+"_"+u;a=i[s];if(a&&a[h]){c=a[h];delete a[h];i[o]--}}else{a=i[e];if(a){for(f=0,l=a.length;f<l;f++){if(a[f].fn===t){c=a[f];a.splice(f,1);break}}}}if(c){c.fn=r.Util.falseFn}},fire:function(e,t,n){if(!this.listens(e,n)){return this}var i=r.Util.extend({},t,{type:e,target:this}),s=this._events;if(s){var o=s[e+"_idx"],u,a,f,l;if(s[e]){f=s[e].slice();for(u=0,a=f.length;u<a;u++){f[u].fn.call(this,i)}}for(l in o){o[l].fn.call(o[l].ctx,i)}}if(n){this._propagateEvent(i)}return this},listens:function(e,t){var n=this._events;if(n&&(n[e]||n[e+"_len"])){return true}if(t){for(var r in this._eventParents){if(this._eventParents[r].listens(e,t)){return true}}}return false},once:function(e,t,n){if(typeof e==="object"){for(var i in e){this.once(i,e[i],t)}return this}var s=r.bind(function(){this.off(e,t,n).off(e,s,n)},this);return this.on(e,t,n).on(e,s,n)},addEventParent:function(e){this._eventParents=this._eventParents||{};this._eventParents[r.stamp(e)]=e;return this},removeEventParent:function(e){if(this._eventParents){delete this._eventParents[r.stamp(e)]}return this},_propagateEvent:function(e){for(var t in this._eventParents){this._eventParents[t].fire(e.type,r.extend({layer:e.target},e),true)}}});var s=r.Evented.prototype;s.addEventListener=s.on;s.removeEventListener=s.clearAllEventListeners=s.off;s.addOneTimeEventListener=s.once;s.fireEvent=s.fire;s.hasEventListeners=s.listens;r.Mixin={Events:s};(function(){var n=navigator.userAgent.toLowerCase(),i=t.documentElement,s="ActiveXObject"in e,o=n.indexOf("webkit")!==-1,u=n.indexOf("phantom")!==-1,a=n.search("android [23]")!==-1,f=n.indexOf("chrome")!==-1,l=typeof orientation!=="undefined",c=navigator.msPointerEnabled&&navigator.msMaxTouchPoints&&!e.PointerEvent,h=e.PointerEvent&&navigator.pointerEnabled&&navigator.maxTouchPoints||c,p=s&&"transition"in i.style,d="WebKitCSSMatrix"in e&&"m11"in new e.WebKitCSSMatrix&&!a,v="MozPerspective"in i.style,m="OTransition"in i.style;var g="devicePixelRatio"in e&&e.devicePixelRatio>1;if(!g&&"matchMedia"in e){var y=e.matchMedia("(min-resolution:144dpi)");g=y&&y.matches}var b=!e.L_NO_TOUCH&&!u&&(h||"ontouchstart"in e||e.DocumentTouch&&t instanceof e.DocumentTouch);r.Browser={ie:s,ielt9:s&&!t.addEventListener,webkit:o,gecko:n.indexOf("gecko")!==-1&&!o&&!e.opera&&!s,android:n.indexOf("android")!==-1,android23:a,chrome:f,safari:!f&&n.indexOf("safari")!==-1,ie3d:p,webkit3d:d,gecko3d:v,opera3d:m,any3d:!e.L_DISABLE_3D&&(p||d||v||m)&&!u,mobile:l,mobileWebkit:l&&o,mobileWebkit3d:l&&d,mobileOpera:l&&e.opera,touch:!!b,msPointer:!!c,pointer:!!h,retina:!!g}})();r.Point=function(e,t,n){this.x=n?Math.round(e):e;this.y=n?Math.round(t):t};r.Point.prototype={clone:function(){return new r.Point(this.x,this.y)},add:function(e){return this.clone()._add(r.point(e))},_add:function(e){this.x+=e.x;this.y+=e.y;return this},subtract:function(e){return this.clone()._subtract(r.point(e))},_subtract:function(e){this.x-=e.x;this.y-=e.y;return this},divideBy:function(e){return this.clone()._divideBy(e)},_divideBy:function(e){this.x/=e;this.y/=e;return this},multiplyBy:function(e){return this.clone()._multiplyBy(e)},_multiplyBy:function(e){this.x*=e;this.y*=e;return this},round:function(){return this.clone()._round()},_round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this},floor:function(){return this.clone()._floor()},_floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this},ceil:function(){return this.clone()._ceil()},_ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this},distanceTo:function(e){e=r.point(e);var t=e.x-this.x,n=e.y-this.y;return Math.sqrt(t*t+n*n)},equals:function(e){e=r.point(e);return e.x===this.x&&e.y===this.y},contains:function(e){e=r.point(e);return Math.abs(e.x)<=Math.abs(this.x)&&Math.abs(e.y)<=Math.abs(this.y)},toString:function(){return"Point("+r.Util.formatNum(this.x)+", "+r.Util.formatNum(this.y)+")"}};r.point=function(e,t,i){if(e instanceof r.Point){return e}if(r.Util.isArray(e)){return new r.Point(e[0],e[1])}if(e===n||e===null){return e}return new r.Point(e,t,i)};r.Bounds=function(e,t){if(!e){return}var n=t?[e,t]:e;for(var r=0,i=n.length;r<i;r++){this.extend(n[r])}};r.Bounds.prototype={extend:function(e){e=r.point(e);if(!this.min&&!this.max){this.min=e.clone();this.max=e.clone()}else{this.min.x=Math.min(e.x,this.min.x);this.max.x=Math.max(e.x,this.max.x);this.min.y=Math.min(e.y,this.min.y);this.max.y=Math.max(e.y,this.max.y)}return this},getCenter:function(e){return new r.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,e)},getBottomLeft:function(){return new r.Point(this.min.x,this.max.y)},getTopRight:function(){return new r.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(e){var t,n;if(typeof e[0]==="number"||e instanceof r.Point){e=r.point(e)}else{e=r.bounds(e)}if(e instanceof r.Bounds){t=e.min;n=e.max}else{t=n=e}return t.x>=this.min.x&&n.x<=this.max.x&&t.y>=this.min.y&&n.y<=this.max.y},intersects:function(e){e=r.bounds(e);var t=this.min,n=this.max,i=e.min,s=e.max,o=s.x>=t.x&&i.x<=n.x,u=s.y>=t.y&&i.y<=n.y;return o&&u},isValid:function(){return!!(this.min&&this.max)}};r.bounds=function(e,t){if(!e||e instanceof r.Bounds){return e}return new r.Bounds(e,t)};r.Transformation=function(e,t,n,r){this._a=e;this._b=t;this._c=n;this._d=r};r.Transformation.prototype={transform:function(e,t){return this._transform(e.clone(),t)},_transform:function(e,t){t=t||1;e.x=t*(this._a*e.x+this._b);e.y=t*(this._c*e.y+this._d);return e},untransform:function(e,t){t=t||1;return new r.Point((e.x/t-this._b)/this._a,(e.y/t-this._d)/this._c)}};r.DomUtil={get:function(e){return typeof e==="string"?t.getElementById(e):e},getStyle:function(e,n){var r=e.style[n]||e.currentStyle&&e.currentStyle[n];if((!r||r==="auto")&&t.defaultView){var i=t.defaultView.getComputedStyle(e,null);r=i?i[n]:null}return r==="auto"?null:r},create:function(e,n,r){var i=t.createElement(e);i.className=n;if(r){r.appendChild(i)}return i},remove:function(e){var t=e.parentNode;if(t){t.removeChild(e)}},empty:function(e){while(e.firstChild){e.removeChild(e.firstChild)}},toFront:function(e){e.parentNode.appendChild(e)},toBack:function(e){var t=e.parentNode;t.insertBefore(e,t.firstChild)},hasClass:function(e,t){if(e.classList!==n){return e.classList.contains(t)}var i=r.DomUtil.getClass(e);return i.length>0&&(new RegExp("(^|\\s)"+t+"(\\s|$)")).test(i)},addClass:function(e,t){if(e.classList!==n){var i=r.Util.splitWords(t);for(var s=0,o=i.length;s<o;s++){e.classList.add(i[s])}}else if(!r.DomUtil.hasClass(e,t)){var u=r.DomUtil.getClass(e);r.DomUtil.setClass(e,(u?u+" ":"")+t)}},removeClass:function(e,t){if(e.classList!==n){e.classList.remove(t)}else{r.DomUtil.setClass(e,r.Util.trim((" "+r.DomUtil.getClass(e)+" ").replace(" "+t+" "," ")))}},setClass:function(e,t){if(e.className.baseVal===n){e.className=t}else{e.className.baseVal=t}},getClass:function(e){return e.className.baseVal===n?e.className:e.className.baseVal},setOpacity:function(e,t){if("opacity"in e.style){e.style.opacity=t}else if("filter"in e.style){var n=false,r="DXImageTransform.Microsoft.Alpha";try{n=e.filters.item(r)}catch(i){if(t===1){return}}t=Math.round(t*100);if(n){n.Enabled=t!==100;n.Opacity=t}else{e.style.filter+=" progid:"+r+"(opacity="+t+")"}}},testProp:function(e){var n=t.documentElement.style;for(var r=0;r<e.length;r++){if(e[r]in n){return e[r]}}return false},setTransform:function(e,t,n){var i=t||new r.Point(0,0);e.style[r.DomUtil.TRANSFORM]="translate3d("+i.x+"px,"+i.y+"px"+",0)"+(n?" scale("+n+")":"")},setPosition:function(e,t,n){e._leaflet_pos=t;if(r.Browser.any3d&&!n){r.DomUtil.setTransform(e,t)}else{e.style.left=t.x+"px";e.style.top=t.y+"px"}},getPosition:function(e){return e._leaflet_pos}};(function(){r.DomUtil.TRANSFORM=r.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]);var n=r.DomUtil.TRANSITION=r.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);r.DomUtil.TRANSITION_END=n==="webkitTransition"||n==="OTransition"?n+"End":"transitionend";if("onselectstart"in t){r.DomUtil.disableTextSelection=function(){r.DomEvent.on(e,"selectstart",r.DomEvent.preventDefault)};r.DomUtil.enableTextSelection=function(){r.DomEvent.off(e,"selectstart",r.DomEvent.preventDefault)}}else{var i=r.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);r.DomUtil.disableTextSelection=function(){if(i){var e=t.documentElement.style;this._userSelect=e[i];e[i]="none"}};r.DomUtil.enableTextSelection=function(){if(i){t.documentElement.style[i]=this._userSelect;delete this._userSelect}}}r.DomUtil.disableImageDrag=function(){r.DomEvent.on(e,"dragstart",r.DomEvent.preventDefault)};r.DomUtil.enableImageDrag=function(){r.DomEvent.off(e,"dragstart",r.DomEvent.preventDefault)}})();r.LatLng=function(e,t,r){if(isNaN(e)||isNaN(t)){throw new Error("Invalid LatLng object: ("+e+", "+t+")")}this.lat=+e;this.lng=+t;if(r!==n){this.alt=+r}};r.LatLng.prototype={equals:function(e,t){if(!e){return false}e=r.latLng(e);var i=Math.max(Math.abs(this.lat-e.lat),Math.abs(this.lng-e.lng));return i<=(t===n?1e-9:t)},toString:function(e){return"LatLng("+r.Util.formatNum(this.lat,e)+", "+r.Util.formatNum(this.lng,e)+")"},distanceTo:function(e){return r.CRS.Earth.distance(this,r.latLng(e))},wrap:function(){return r.CRS.Earth.wrapLatLng(this)}};r.latLng=function(e,t){if(e instanceof r.LatLng){return e}if(r.Util.isArray(e)&&typeof e[0]!=="object"){if(e.length===3){return new r.LatLng(e[0],e[1],e[2])}return new r.LatLng(e[0],e[1])}if(e===n||e===null){return e}if(typeof e==="object"&&"lat"in e){return new r.LatLng(e.lat,"lng"in e?e.lng:e.lon)}if(t===n){return null}return new r.LatLng(e,t)};r.LatLngBounds=function(e,t){if(!e){return}var n=t?[e,t]:e;for(var r=0,i=n.length;r<i;r++){this.extend(n[r])}};r.LatLngBounds.prototype={extend:function(e){var t=this._southWest,n=this._northEast,i,s;if(e instanceof r.LatLng){i=e;s=e}else if(e instanceof r.LatLngBounds){i=e._southWest;s=e._northEast;if(!i||!s){return this}}else{return e?this.extend(r.latLng(e)||r.latLngBounds(e)):this}if(!t&&!n){this._southWest=new r.LatLng(i.lat,i.lng);this._northEast=new r.LatLng(s.lat,s.lng)}else{t.lat=Math.min(i.lat,t.lat);t.lng=Math.min(i.lng,t.lng);n.lat=Math.max(s.lat,n.lat);n.lng=Math.max(s.lng,n.lng)}return this},pad:function(e){var t=this._southWest,n=this._northEast,i=Math.abs(t.lat-n.lat)*e,s=Math.abs(t.lng-n.lng)*e;return new r.LatLngBounds(new r.LatLng(t.lat-i,t.lng-s),new r.LatLng(n.lat+i,n.lng+s))},getCenter:function(){return new r.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new r.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new r.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(e){if(typeof e[0]==="number"||e instanceof r.LatLng){e=r.latLng(e)}else{e=r.latLngBounds(e)}var t=this._southWest,n=this._northEast,i,s;if(e instanceof r.LatLngBounds){i=e.getSouthWest();s=e.getNorthEast()}else{i=s=e}return i.lat>=t.lat&&s.lat<=n.lat&&i.lng>=t.lng&&s.lng<=n.lng},intersects:function(e){e=r.latLngBounds(e);var t=this._southWest,n=this._northEast,i=e.getSouthWest(),s=e.getNorthEast(),o=s.lat>=t.lat&&i.lat<=n.lat,u=s.lng>=t.lng&&i.lng<=n.lng;return o&&u},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(e){if(!e){return false}e=r.latLngBounds(e);return this._southWest.equals(e.getSouthWest())&&this._northEast.equals(e.getNorthEast())},isValid:function(){return!!(this._southWest&&this._northEast)}};r.latLngBounds=function(e,t){if(!e||e instanceof r.LatLngBounds){return e}return new r.LatLngBounds(e,t)};r.Projection={};r.Projection.LonLat={project:function(e){return new r.Point(e.lng,e.lat)},unproject:function(e){return new r.LatLng(e.y,e.x)},bounds:r.bounds([-180,-90],[180,90])};r.Projection.SphericalMercator={R:6378137,project:function(e){var t=Math.PI/180,n=1-1e-15,i=Math.max(Math.min(Math.sin(e.lat*t),n),-n);return new r.Point(this.R*e.lng*t,this.R*Math.log((1+i)/(1-i))/2)},unproject:function(e){var t=180/Math.PI;return new r.LatLng((2*Math.atan(Math.exp(e.y/this.R))-Math.PI/2)*t,e.x*t/this.R)},bounds:function(){var e=6378137*Math.PI;return r.bounds([-e,-e],[e,e])}()};r.CRS={latLngToPoint:function(e,t){var n=this.projection.project(e),r=this.scale(t);return this.transformation._transform(n,r)},pointToLatLng:function(e,t){var n=this.scale(t),r=this.transformation.untransform(e,n);return this.projection.unproject(r)},project:function(e){return this.projection.project(e)},unproject:function(e){return this.projection.unproject(e)},scale:function(e){return 256*Math.pow(2,e)},getProjectedBounds:function(e){if(this.infinite){return null}var t=this.projection.bounds,n=this.scale(e),i=this.transformation.transform(t.min,n),s=this.transformation.transform(t.max,n);return r.bounds(i,s)},wrapLatLng:function(e){var t=this.wrapLng?r.Util.wrapNum(e.lng,this.wrapLng,true):e.lng,n=this.wrapLat?r.Util.wrapNum(e.lat,this.wrapLat,true):e.lat;return r.latLng(n,t)}};r.CRS.Simple=r.extend({},r.CRS,{projection:r.Projection.LonLat,transformation:new r.Transformation(1,0,-1,0),scale:function(e){return Math.pow(2,e)},distance:function(e,t){var n=t.lng-e.lng,r=t.lat-e.lat;return Math.sqrt(n*n+r*r)},infinite:true});r.CRS.Earth=r.extend({},r.CRS,{wrapLng:[-180,180],R:6378137,distance:function(e,t){var n=Math.PI/180,r=e.lat*n,i=t.lat*n,s=Math.sin(r)*Math.sin(i)+Math.cos(r)*Math.cos(i)*Math.cos((t.lng-e.lng)*n);return this.R*Math.acos(Math.min(s,1))}});r.CRS.EPSG3857=r.extend({},r.CRS.Earth,{code:"EPSG:3857",projection:r.Projection.SphericalMercator,transformation:function(){var e=.5/(Math.PI*r.Projection.SphericalMercator.R);return new r.Transformation(e,.5,-e,.5)}()});r.CRS.EPSG900913=r.extend({},r.CRS.EPSG3857,{code:"EPSG:900913"});r.CRS.EPSG4326=r.extend({},r.CRS.Earth,{code:"EPSG:4326",projection:r.Projection.LonLat,transformation:new r.Transformation(1/180,1,-1/180,.5)});r.Map=r.Evented.extend({options:{crs:r.CRS.EPSG3857,fadeAnimation:true,trackResize:true,markerZoomAnimation:true},initialize:function(e,t){t=r.setOptions(this,t);this._initContainer(e);this._initLayout();this._onResize=r.bind(this._onResize,this);this._initEvents();if(t.maxBounds){this.setMaxBounds(t.maxBounds)}if(t.center&&t.zoom!==n){this.setView(r.latLng(t.center),t.zoom,{reset:true})}this._handlers=[];this._layers={};this._zoomBoundLayers={};this.callInitHooks();this._addLayers(this.options.layers)},setView:function(e,t){t=t===n?this.getZoom():t;this._resetView(r.latLng(e),this._limitZoom(t));return this},setZoom:function(e,t){if(!this._loaded){this._zoom=this._limitZoom(e);return this}return this.setView(this.getCenter(),e,{zoom:t})},zoomIn:function(e,t){return this.setZoom(this._zoom+(e||1),t)},zoomOut:function(e,t){return this.setZoom(this._zoom-(e||1),t)},setZoomAround:function(e,t,n){var i=this.getZoomScale(t),s=this.getSize().divideBy(2),o=e instanceof r.Point?e:this.latLngToContainerPoint(e),u=o.subtract(s).multiplyBy(1-1/i),a=this.containerPointToLatLng(s.add(u));return this.setView(a,t,{zoom:n})},fitBounds:function(e,t){t=t||{};e=e.getBounds?e.getBounds():r.latLngBounds(e);var n=r.point(t.paddingTopLeft||t.padding||[0,0]),i=r.point(t.paddingBottomRight||t.padding||[0,0]),s=this.getBoundsZoom(e,false,n.add(i));s=t.maxZoom?Math.min(t.maxZoom,s):s;var o=i.subtract(n).divideBy(2),u=this.project(e.getSouthWest(),s),a=this.project(e.getNorthEast(),s),f=this.unproject(u.add(a).divideBy(2).add(o),s);return this.setView(f,s,t)},fitWorld:function(e){return this.fitBounds([[-90,-180],[90,180]],e)},panTo:function(e,t){return this.setView(e,this._zoom,{pan:t})},panBy:function(e){this.fire("movestart");this._rawPanBy(r.point(e));this.fire("move");return this.fire("moveend")},setMaxBounds:function(e){e=r.latLngBounds(e);this.options.maxBounds=e;if(!e){return this.off("moveend",this._panInsideMaxBounds)}if(this._loaded){this._panInsideMaxBounds()}return this.on("moveend",this._panInsideMaxBounds)},panInsideBounds:function(e,t){var n=this.getCenter(),r=this._limitCenter(n,this._zoom,e);if(n.equals(r)){return this}return this.panTo(r,t)},invalidateSize:function(e){if(!this._loaded){return this}e=r.extend({animate:false,pan:true},e===true?{animate:true}:e);var t=this.getSize();this._sizeChanged=true;this._initialCenter=null;var n=this.getSize(),i=t.divideBy(2).round(),s=n.divideBy(2).round(),o=i.subtract(s);if(!o.x&&!o.y){return this}if(e.animate&&e.pan){this.panBy(o)}else{if(e.pan){this._rawPanBy(o)}this.fire("move");if(e.debounceMoveend){clearTimeout(this._sizeTimer);this._sizeTimer=setTimeout(r.bind(this.fire,this,"moveend"),200)}else{this.fire("moveend")}}return this.fire("resize",{oldSize:t,newSize:n})},addHandler:function(e,t){if(!t){return this}var n=this[e]=new t(this);this._handlers.push(n);if(this.options[e]){n.enable()}return this},remove:function(){this._initEvents("off");try{delete this._container._leaflet}catch(e){this._container._leaflet=n}r.DomUtil.remove(this._mapPane);if(this._clearControlPos){this._clearControlPos()}this._clearHandlers();if(this._loaded){this.fire("unload")}return this},createPane:function(e,t){var n="leaflet-pane"+(e?" leaflet-"+e.replace("Pane","")+"-pane":""),i=r.DomUtil.create("div",n,t||this._mapPane);if(e){this._panes[e]=i}return i},getCenter:function(){this._checkIfLoaded();if(this._initialCenter&&!this._moved()){return this._initialCenter}return this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var e=this.getPixelBounds(),t=this.unproject(e.getBottomLeft()),n=this.unproject(e.getTopRight());return new r.LatLngBounds(t,n)},getMinZoom:function(){return this.options.minZoom===n?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===n?this._layersMaxZoom===n?Infinity:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(e,t,n){e=r.latLngBounds(e);var i=this.getMinZoom()-(t?1:0),s=this.getMaxZoom(),o=this.getSize(),u=e.getNorthWest(),a=e.getSouthEast(),f=true,l;n=r.point(n||[0,0]);do{i++;l=this.project(a,i).subtract(this.project(u,i)).add(n);f=!t?o.contains(l):l.x<o.x||l.y<o.y}while(f&&i<=s);if(f&&t){return null}return t?i:i-1},getSize:function(){if(!this._size||this._sizeChanged){this._size=new r.Point(this._container.clientWidth,this._container.clientHeight);this._sizeChanged=false}return this._size.clone()},getPixelBounds:function(){var e=this._getTopLeftPoint();return new r.Bounds(e,e.add(this.getSize()))},getPixelOrigin:function(){this._checkIfLoaded();return this._initialTopLeftPoint},getPixelWorldBounds:function(){return this.options.crs.getProjectedBounds(this.getZoom())},getPane:function(e){return typeof e==="string"?this._panes[e]:e},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(e){var t=this.options.crs;return t.scale(e)/t.scale(this._zoom)},getScaleZoom:function(e){return this._zoom+Math.log(e)/Math.LN2},project:function(e,t){t=t===n?this._zoom:t;return this.options.crs.latLngToPoint(r.latLng(e),t)},unproject:function(e,t){t=t===n?this._zoom:t;return this.options.crs.pointToLatLng(r.point(e),t)},layerPointToLatLng:function(e){var t=r.point(e).add(this.getPixelOrigin());return this.unproject(t)},latLngToLayerPoint:function(e){var t=this.project(r.latLng(e))._round();return t._subtract(this.getPixelOrigin())},wrapLatLng:function(e){return this.options.crs.wrapLatLng(r.latLng(e))},distance:function(e,t){return this.options.crs.distance(r.latLng(e),r.latLng(t))},containerPointToLayerPoint:function(e){return r.point(e).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(e){return r.point(e).add(this._getMapPanePos())},containerPointToLatLng:function(e){var t=this.containerPointToLayerPoint(r.point(e));return this.layerPointToLatLng(t)},latLngToContainerPoint:function(e){return this.layerPointToContainerPoint(this.latLngToLayerPoint(r.latLng(e)))},mouseEventToContainerPoint:function(e){return r.DomEvent.getMousePosition(e,this._container)},mouseEventToLayerPoint:function(e){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(e))},mouseEventToLatLng:function(e){return this.layerPointToLatLng(this.mouseEventToLayerPoint(e))},_initContainer:function(e){var t=this._container=r.DomUtil.get(e);if(!t){throw new Error("Map container not found.")}else if(t._leaflet){throw new Error("Map container is already initialized.")}t._leaflet=true},_initLayout:function(){var e=this._container;this._fadeAnimated=this.options.fadeAnimation&&r.Browser.any3d;r.DomUtil.addClass(e,"leaflet-container"+(r.Browser.touch?" leaflet-touch":"")+(r.Browser.retina?" leaflet-retina":"")+(r.Browser.ielt9?" leaflet-oldie":"")+(r.Browser.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var t=r.DomUtil.getStyle(e,"position");if(t!=="absolute"&&t!=="relative"&&t!=="fixed"){e.style.position="relative"}this._initPanes();if(this._initControlPos){this._initControlPos()}},_initPanes:function(){var e=this._panes={};this._mapPane=this.createPane("mapPane",this._container);this.createPane("tilePane");this.createPane("shadowPane");this.createPane("overlayPane");this.createPane("markerPane");this.createPane("popupPane");if(!this.options.markerZoomAnimation){r.DomUtil.addClass(e.markerPane,"leaflet-zoom-hide");r.DomUtil.addClass(e.shadowPane,"leaflet-zoom-hide")}},_resetView:function(e,t,n,i){var s=this._zoom!==t;if(!i){this.fire("movestart");if(s){this.fire("zoomstart")}}this._zoom=t;this._initialCenter=e;this._initialTopLeftPoint=this._getNewTopLeftPoint(e);if(!n){r.DomUtil.setPosition(this._mapPane,new r.Point(0,0))}else{this._initialTopLeftPoint._add(this._getMapPanePos())}var o=!this._loaded;this._loaded=true;this.fire("viewreset",{hard:!n});if(o){this.fire("load")}this.fire("move");if(s||i){this.fire("zoomend")}this.fire("moveend",{hard:!n})},_rawPanBy:function(e){r.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(e))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded){throw new Error("Set map center and zoom first.")}},_initEvents:function(t){if(!r.DomEvent){return}t=t||"on";r.DomEvent[t](this._container,"click dblclick mousedown mouseup mouseenter mouseleave mousemove contextmenu",this._handleMouseEvent,this);if(this.options.trackResize){r.DomEvent[t](e,"resize",this._onResize,this)}},_onResize:function(){r.Util.cancelAnimFrame(this._resizeRequest);this._resizeRequest=r.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:true})},this,false,this._container)},_handleMouseEvent:function(e){if(!this._loaded){return}this._fireMouseEvent(this,e,e.type==="mouseenter"?"mouseover":e.type==="mouseleave"?"mouseout":e.type)},_fireMouseEvent:function(e,t,n,i,s){n=n||t.type;if(r.DomEvent._skipped(t)){return}if(n==="click"){if(!t._simulated&&(this.dragging&&this.dragging.moved()||this.boxZoom&&this.boxZoom.moved())){return}e.fire("preclick")}if(!e.listens(n,i)){return}if(n==="contextmenu"){r.DomEvent.preventDefault(t)}if(n==="click"||n==="dblclick"||n==="contextmenu"){r.DomEvent.stopPropagation(t)}var o={originalEvent:t,containerPoint:this.mouseEventToContainerPoint(t)};o.layerPoint=this.containerPointToLayerPoint(o.containerPoint);o.latlng=s||this.layerPointToLatLng(o.layerPoint);e.fire(n,o,i)},_clearHandlers:function(){for(var e=0,t=this._handlers.length;e<t;e++){this._handlers[e].disable()}},whenReady:function(e,t){if(this._loaded){e.call(t||this,{target:this})}else{this.on("load",e,t)}return this},_getMapPanePos:function(){return r.DomUtil.getPosition(this._mapPane)},_moved:function(){var e=this._getMapPanePos();return e&&!e.equals([0,0])},_getTopLeftPoint:function(){return this.getPixelOrigin().subtract(this._getMapPanePos())},_getNewTopLeftPoint:function(e,t){var n=this.getSize()._divideBy(2);return this.project(e,t)._subtract(n)._round()},_latLngToNewLayerPoint:function(e,t,n){var r=this._getNewTopLeftPoint(n,t).add(this._getMapPanePos());return this.project(e,t)._subtract(r)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(e){return this.latLngToLayerPoint(e).subtract(this._getCenterLayerPoint())},_limitCenter:function(e,t,n){if(!n){return e}var i=this.project(e,t),s=this.getSize().divideBy(2),o=new r.Bounds(i.subtract(s),i.add(s)),u=this._getBoundsOffset(o,n,t);return this.unproject(i.add(u),t)},_limitOffset:function(e,t){if(!t){return e}var n=this.getPixelBounds(),i=new r.Bounds(n.min.add(e),n.max.add(e));return e.add(this._getBoundsOffset(i,t))},_getBoundsOffset:function(e,t,n){var i=this.project(t.getNorthWest(),n).subtract(e.min),s=this.project(t.getSouthEast(),n).subtract(e.max),o=this._rebound(i.x,-s.x),u=this._rebound(i.y,-s.y);return new r.Point(o,u)},_rebound:function(e,t){return e+t>0?Math.round(e-t)/2:Math.max(0,Math.ceil(e))-Math.max(0,Math.floor(t))},_limitZoom:function(e){var t=this.getMinZoom(),n=this.getMaxZoom();return Math.max(t,Math.min(n,e))}});r.map=function(e,t){return new r.Map(e,t)};r.Layer=r.Evented.extend({options:{pane:"overlayPane"},addTo:function(e){e.addLayer(this);return this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(e){if(e){e.removeLayer(this)}return this},getPane:function(e){return this._map.getPane(e?this.options[e]||e:this.options.pane)},_layerAdd:function(e){var t=e.target;if(!t.hasLayer(this)){return}this._map=t;this._zoomAnimated=t._zoomAnimated;this.onAdd(t);if(this.getAttribution&&this._map.attributionControl){this._map.attributionControl.addAttribution(this.getAttribution())}if(this.getEvents){t.on(this.getEvents(),this)}this.fire("add");t.fire("layeradd",{layer:this})}});r.Map.include({addLayer:function(e){var t=r.stamp(e);if(this._layers[t]){return e}this._layers[t]=e;e._mapToAdd=this;if(e.beforeAdd){e.beforeAdd(this)}this.whenReady(e._layerAdd,e);return this},removeLayer:function(e){var t=r.stamp(e);if(!this._layers[t]){return this}if(this._loaded){e.onRemove(this)}if(e.getAttribution&&this.attributionControl){this.attributionControl.removeAttribution(e.getAttribution())}if(e.getEvents){this.off(e.getEvents(),e)}delete this._layers[t];if(this._loaded){this.fire("layerremove",{layer:e});e.fire("remove")}e._map=e._mapToAdd=null;return this},hasLayer:function(e){return!!e&&r.stamp(e)in this._layers},eachLayer:function(e,t){for(var n in this._layers){e.call(t,this._layers[n])}return this},_addLayers:function(e){e=e?r.Util.isArray(e)?e:[e]:[];for(var t=0,n=e.length;t<n;t++){this.addLayer(e[t])}},_addZoomLimit:function(e){if(isNaN(e.options.maxZoom)||!isNaN(e.options.minZoom)){this._zoomBoundLayers[r.stamp(e)]=e;this._updateZoomLevels()}},_removeZoomLimit:function(e){var t=r.stamp(e);if(this._zoomBoundLayers[t]){delete this._zoomBoundLayers[t];this._updateZoomLevels()}},_updateZoomLevels:function(){var e=Infinity,t=-Infinity,r=this._getZoomSpan();for(var i in this._zoomBoundLayers){var s=this._zoomBoundLayers[i].options;e=s.minZoom===n?e:Math.min(e,s.minZoom);t=s.maxZoom===n?t:Math.max(t,s.maxZoom)}this._layersMaxZoom=t===-Infinity?n:t;this._layersMinZoom=e===Infinity?n:e;if(r!==this._getZoomSpan()){this.fire("zoomlevelschange")}}});r.Projection.Mercator={R:6378137,R_MINOR:6356752.314245179,bounds:r.bounds([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(e){var t=Math.PI/180,n=this.R,i=e.lat*t,s=this.R_MINOR/n,o=Math.sqrt(1-s*s),u=o*Math.sin(i);var a=Math.tan(Math.PI/4-i/2)/Math.pow((1-u)/(1+u),o/2);i=-n*Math.log(Math.max(a,1e-10));return new r.Point(e.lng*t*n,i)},unproject:function(e){var t=180/Math.PI,n=this.R,i=this.R_MINOR/n,s=Math.sqrt(1-i*i),o=Math.exp(-e.y/n),u=Math.PI/2-2*Math.atan(o);for(var a=0,f=.1,l;a<15&&Math.abs(f)>1e-7;a++){l=s*Math.sin(u);l=Math.pow((1-l)/(1+l),s/2);f=Math.PI/2-2*Math.atan(o*l)-u;u+=f}return new r.LatLng(u*t,e.x*t/n)}};r.CRS.EPSG3395=r.extend({},r.CRS.Earth,{code:"EPSG:3395",projection:r.Projection.Mercator,transformation:function(){var e=.5/(Math.PI*r.Projection.Mercator.R);return new r.Transformation(e,.5,-e,.5)}()});r.GridLayer=r.Layer.extend({options:{pane:"tilePane",tileSize:256,opacity:1,unloadInvisibleTiles:r.Browser.mobile,updateWhenIdle:r.Browser.mobile,updateInterval:150},initialize:function(e){e=r.setOptions(this,e)},onAdd:function(){this._initContainer();if(!this.options.updateWhenIdle){this._update=r.Util.throttle(this._update,this.options.updateInterval,this)}this._reset();this._update()},beforeAdd:function(e){e._addZoomLimit(this)},onRemove:function(e){this._clearBgBuffer();r.DomUtil.remove(this._container);e._removeZoomLimit(this);this._container=null},bringToFront:function(){if(this._map){r.DomUtil.toFront(this._container);this._setAutoZIndex(Math.max)}return this},bringToBack:function(){if(this._map){r.DomUtil.toBack(this._container);this._setAutoZIndex(Math.min)}return this},getAttribution:function(){return this.options.attribution},getContainer:function(){return this._container},setOpacity:function(e){this.options.opacity=e;if(this._map){this._updateOpacity()}return this},setZIndex:function(e){this.options.zIndex=e;this._updateZIndex();return this},redraw:function(){if(this._map){this._reset({hard:true});this._update()}return this},getEvents:function(){var e={viewreset:this._reset,moveend:this._update};if(!this.options.updateWhenIdle){e.move=this._update}if(this._zoomAnimated){e.zoomstart=this._startZoomAnim;e.zoomanim=this._animateZoom;e.zoomend=this._endZoomAnim}return e},_updateZIndex:function(){if(this._container&&this.options.zIndex!==n){this._container.style.zIndex=this.options.zIndex}},_setAutoZIndex:function(e){var t=this.getPane().children,n=-e(-Infinity,Infinity);for(var r=0,i=t.length,s;r<i;r++){s=t[r].style.zIndex;if(t[r]!==this._container&&s){n=e(n,+s)}}if(isFinite(n)){this.options.zIndex=n+e(-1,1);this._updateZIndex()}},_updateOpacity:function(){var e=this.options.opacity;if(r.Browser.ielt9){for(var t in this._tiles){r.DomUtil.setOpacity(this._tiles[t],e)}}else{r.DomUtil.setOpacity(this._container,e)}},_initContainer:function(){if(this._container){return}this._container=r.DomUtil.create("div","leaflet-layer");this._updateZIndex();if(this._zoomAnimated){var e="leaflet-tile-container leaflet-zoom-animated";this._bgBuffer=r.DomUtil.create("div",e,this._container);this._tileContainer=r.DomUtil.create("div",e,this._container);r.DomUtil.setTransform(this._tileContainer)}else{this._tileContainer=this._container}if(this.options.opacity<1){this._updateOpacity()}this.getPane().appendChild(this._container)},_reset:function(e){for(var t in this._tiles){this.fire("tileunload",{tile:this._tiles[t]})}this._tiles={};this._tilesToLoad=0;this._tilesTotal=0;r.DomUtil.empty(this._tileContainer);if(this._zoomAnimated&&e&&e.hard){this._clearBgBuffer()}this._tileNumBounds=this._getTileNumBounds();this._resetWrap()},_resetWrap:function(){var e=this._map,t=e.options.crs;if(t.infinite){return}var n=this._getTileSize();if(t.wrapLng){this._wrapLng=[Math.floor(e.project([0,t.wrapLng[0]]).x/n),Math.ceil(e.project([0,t.wrapLng[1]]).x/n)]}if(t.wrapLat){this._wrapLat=[Math.floor(e.project([t.wrapLat[0],0]).y/n),Math.ceil(e.project([t.wrapLat[1],0]).y/n)]}},_getTileSize:function(){return this.options.tileSize},_update:function(){if(!this._map){return}var e=this._map.getPixelBounds(),t=this._map.getZoom(),n=this._getTileSize();if(t>this.options.maxZoom||t<this.options.minZoom){return}var i=r.bounds(e.min.divideBy(n).floor(),e.max.divideBy(n).floor());this._addTiles(i);if(this.options.unloadInvisibleTiles){this._removeOtherTiles(i)}},_addTiles:function(e){var n=[],i=e.getCenter(),s=this._map.getZoom();var o,u,a;for(o=e.min.y;o<=e.max.y;o++){for(u=e.min.x;u<=e.max.x;u++){a=new r.Point(u,o);a.z=s;if(!(this._tileCoordsToKey(a)in this._tiles)&&this._isValidTile(a)){n.push(a)}}}var f=n.length;if(f===0){return}if(!this._tilesToLoad){this.fire("loading")}this._tilesToLoad+=f;this._tilesTotal+=f;n.sort(function(e,t){return e.distanceTo(i)-t.distanceTo(i)});var l=t.createDocumentFragment();for(u=0;u<f;u++){this._addTile(n[u],l)}this._tileContainer.appendChild(l)},_isValidTile:function(e){var t=this._map.options.crs;if(!t.infinite){var n=this._tileNumBounds;if(!t.wrapLng&&(e.x<n.min.x||e.x>n.max.x)||!t.wrapLat&&(e.y<n.min.y||e.y>n.max.y)){return false}}if(!this.options.bounds){return true}var i=this._tileCoordsToBounds(e);return r.latLngBounds(this.options.bounds).intersects(i)},_tileCoordsToBounds:function(e){var t=this._map,n=this._getTileSize(),i=e.multiplyBy(n),s=i.add([n,n]),o=t.wrapLatLng(t.unproject(i,e.z)),u=t.wrapLatLng(t.unproject(s,e.z));return new r.LatLngBounds(o,u)},_tileCoordsToKey:function(e){return e.x+":"+e.y},_keyToTileCoords:function(e){var t=e.split(":"),n=parseInt(t[0],10),i=parseInt(t[1],10);return new r.Point(n,i)},_removeOtherTiles:function(e){for(var t in this._tiles){if(!e.contains(this._keyToTileCoords(t))){this._removeTile(t)}}},_removeTile:function(e){var t=this._tiles[e];r.DomUtil.remove(t);delete this._tiles[e];this.fire("tileunload",{tile:t})},_initTile:function(e){var t=this._getTileSize();r.DomUtil.addClass(e,"leaflet-tile");e.style.width=t+"px";e.style.height=t+"px";e.onselectstart=r.Util.falseFn;e.onmousemove=r.Util.falseFn;if(r.Browser.ielt9&&this.options.opacity<1){r.DomUtil.setOpacity(e,this.options.opacity)}if(r.Browser.android&&!r.Browser.android23){e.style.WebkitBackfaceVisibility="hidden"}},_addTile:function(e,t){var n=this._getTilePos(e);this._wrapCoords(e);var i=this.createTile(e,r.bind(this._tileReady,this));this._initTile(i);if(this.createTile.length<2){setTimeout(r.bind(this._tileReady,this,null,i),0)}r.DomUtil.setPosition(i,n,true);this._tiles[this._tileCoordsToKey(e)]=i;t.appendChild(i);this.fire("tileloadstart",{tile:i})},_tileReady:function(e,t){if(e){this.fire("tileerror",{error:e,tile:t})}r.DomUtil.addClass(t,"leaflet-tile-loaded");this.fire("tileload",{tile:t});this._tilesToLoad--;if(this._tilesToLoad===0){this._visibleTilesReady()}},_visibleTilesReady:function(){this.fire("load");if(this._zoomAnimated){clearTimeout(this._clearBgBufferTimer);this._clearBgBufferTimer=setTimeout(r.bind(this._clearBgBuffer,this),300)}},_getTilePos:function(e){return e.multiplyBy(this._getTileSize()).subtract(this._map.getPixelOrigin())},_wrapCoords:function(e){e.x=this._wrapLng?r.Util.wrapNum(e.x,this._wrapLng):e.x;e.y=this._wrapLat?r.Util.wrapNum(e.y,this._wrapLat):e.y},_getTileNumBounds:function(){var e=this._map.getPixelWorldBounds(),t=this._getTileSize();return e?r.bounds(e.min.divideBy(t).floor(),e.max.divideBy(t).ceil().subtract([1,1])):null},_startZoomAnim:function(){this._prepareBgBuffer();this._prevTranslate=this._translate||new r.Point(0,0);this._prevScale=this._scale},_animateZoom:function(e){this._translate=this._prevTranslate.multiplyBy(e.scale).add(e.origin.multiplyBy(1-e.scale));this._scale=this._prevScale*e.scale;r.DomUtil.setTransform(this._bgBuffer,this._translate,this._scale)},_endZoomAnim:function(){var e=this._tileContainer;e.style.visibility="";r.DomUtil.toFront(e)},_clearBgBuffer:function(){var e=this._map,t=this._bgBuffer;if(e&&!e._animatingZoom&&!e.touchZoom._zooming&&t){r.DomUtil.empty(t);r.DomUtil.setTransform(t)}},_prepareBgBuffer:function(){var e=this._tileContainer,t=this._bgBuffer;if(this._abortLoading){this._abortLoading()}if(this._tilesToLoad/this._tilesTotal>.5){e.style.visibility="hidden";return}t.style.visibility="hidden";r.DomUtil.setTransform(t);this._tileContainer=t;this._bgBuffer=e;this._translate=new r.Point(0,0);this._scale=1;clearTimeout(this._clearBgBufferTimer)}});r.gridLayer=function(e){return new r.GridLayer(e)};r.TileLayer=r.GridLayer.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",zoomOffset:0},initialize:function(e,t){this._url=e;t=r.setOptions(this,t);if(t.detectRetina&&r.Browser.retina&&t.maxZoom>0){t.tileSize=Math.floor(t.tileSize/2);t.zoomOffset++;t.minZoom=Math.max(0,t.minZoom);t.maxZoom--}if(typeof t.subdomains==="string"){t.subdomains=t.subdomains.split("")}},setUrl:function(e,t){this._url=e;if(!t){this.redraw()}return this},createTile:function(e,n){var i=t.createElement("img");i.onload=r.bind(this._tileOnLoad,this,n,i);i.onerror=r.bind(this._tileOnError,this,n,i);if(this.options.crossOrigin){i.crossOrigin=""}i.alt="";i.src=this.getTileUrl(e);return i},getTileUrl:function(e){return r.Util.template(this._url,r.extend({r:this.options.detectRetina&&r.Browser.retina&&this.options.maxZoom>0?"@2x":"",s:this._getSubdomain(e),x:e.x,y:this.options.tms?this._tileNumBounds.max.y-e.y:e.y,z:this._getZoomForUrl()},this.options))},_tileOnLoad:function(e,t){e(null,t)},_tileOnError:function(e,t,n){var r=this.options.errorTileUrl;if(r){t.src=r}e(n,t)},_getTileSize:function(){var e=this._map,t=this.options,n=e.getZoom()+t.zoomOffset,r=t.maxNativeZoom;return r&&n>r?Math.round(e.getZoomScale(n)/e.getZoomScale(r)*t.tileSize):t.tileSize},_removeTile:function(e){var t=this._tiles[e];r.GridLayer.prototype._removeTile.call(this,e);if(!r.Browser.android){t.onload=null;t.src=r.Util.emptyImageUrl}},_getZoomForUrl:function(){var e=this.options,t=this._map.getZoom();if(e.zoomReverse){t=e.maxZoom-t}t+=e.zoomOffset;return e.maxNativeZoom?Math.min(t,e.maxNativeZoom):t},_getSubdomain:function(e){var t=Math.abs(e.x+e.y)%this.options.subdomains.length;return this.options.subdomains[t]},_abortLoading:function(){var e,t;for(e in this._tiles){t=this._tiles[e];if(!t.complete){t.onload=r.Util.falseFn;t.onerror=r.Util.falseFn;t.src=r.Util.emptyImageUrl;r.DomUtil.remove(t)}}}});r.tileLayer=function(e,t){return new r.TileLayer(e,t)};r.TileLayer.WMS=r.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:false},initialize:function(e,t){this._url=e;var n=r.extend({},this.defaultWmsParams);for(var i in t){if(!this.options.hasOwnProperty(i)&&i!=="crs"){n[i]=t[i]}}t=r.setOptions(this,t);n.width=n.height=t.tileSize*(t.detectRetina&&r.Browser.retina?2:1);this.wmsParams=n},onAdd:function(e){this._crs=this.options.crs||e.options.crs;this._wmsVersion=parseFloat(this.wmsParams.version);var t=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[t]=this._crs.code;r.TileLayer.prototype.onAdd.call(this,e)},getTileUrl:function(e){var t=this._tileCoordsToBounds(e),n=this._crs.project(t.getNorthWest()),i=this._crs.project(t.getSouthEast()),s=(this._wmsVersion>=1.3&&this._crs===r.CRS.EPSG4326?[i.y,n.x,n.y,i.x]:[n.x,i.y,i.x,n.y]).join(","),o=r.TileLayer.prototype.getTileUrl.call(this,e);return o+r.Util.getParamString(this.wmsParams,o,true)+"&BBOX="+s},setParams:function(e,t){r.extend(this.wmsParams,e);if(!t){this.redraw()}return this}});r.tileLayer.wms=function(e,t){return new r.TileLayer.WMS(e,t)};r.ImageOverlay=r.Layer.extend({options:{opacity:1,alt:""},initialize:function(e,t,n){this._url=e;this._bounds=r.latLngBounds(t);r.setOptions(this,n)},onAdd:function(){if(!this._image){this._initImage();if(this.options.opacity<1){this._updateOpacity()}}this.getPane().appendChild(this._image);this._reset()},onRemove:function(){r.DomUtil.remove(this._image)},setOpacity:function(e){this.options.opacity=e;if(this._image){this._updateOpacity()}return this},bringToFront:function(){if(this._map){r.DomUtil.toFront(this._image)}return this},bringToBack:function(){if(this._map){r.DomUtil.toBack(this._image)}return this},setUrl:function(e){this._url=e;if(this._image){this._image.src=e}return this},getAttribution:function(){return this.options.attribution},getEvents:function(){var e={viewreset:this._reset};if(this._zoomAnimated){e.zoomanim=this._animateZoom}return e},_initImage:function(){var e=this._image=r.DomUtil.create("img","leaflet-image-layer "+(this._zoomAnimated?"leaflet-zoom-animated":""));e.onselectstart=r.Util.falseFn;e.onmousemove=r.Util.falseFn;e.onload=r.bind(this.fire,this,"load");e.src=this._url;e.alt=this.options.alt},_animateZoom:function(e){var t=this._map._latLngToNewLayerPoint(this._bounds.getNorthWest(),e.zoom,e.center),n=this._map._latLngToNewLayerPoint(this._bounds.getSouthEast(),e.zoom,e.center).subtract(t),i=t.add(n._multiplyBy((1-1/e.scale)/2));r.DomUtil.setTransform(this._image,i,e.scale)},_reset:function(){var e=this._image,t=new r.Bounds(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),n=t.getSize();r.DomUtil.setPosition(e,t.min);e.style.width=n.x+"px";e.style.height=n.y+"px"},_updateOpacity:function(){r.DomUtil.setOpacity(this._image,this.options.opacity)}});r.imageOverlay=function(e,t,n){return new r.ImageOverlay(e,t,n)};r.Icon=r.Class.extend({initialize:function(e){r.setOptions(this,e)},createIcon:function(e){return this._createIcon("icon",e)},createShadow:function(e){return this._createIcon("shadow",e)},_createIcon:function(e,t){var n=this._getIconUrl(e);if(!n){if(e==="icon"){throw new Error("iconUrl not set in Icon options (see the docs).")}return null}var r=this._createImg(n,t&&t.tagName==="IMG"?t:null);this._setIconStyles(r,e);return r},_setIconStyles:function(e,t){var n=this.options,i=r.point(n[t+"Size"]),s=r.point(t==="shadow"&&n.shadowAnchor||n.iconAnchor||i&&i.divideBy(2,true));e.className="leaflet-marker-"+t+" "+(n.className||"");if(s){e.style.marginLeft=-s.x+"px";e.style.marginTop=-s.y+"px"}if(i){e.style.width=i.x+"px";e.style.height=i.y+"px"}},_createImg:function(e,n){n=n||t.createElement("img");n.src=e;return n},_getIconUrl:function(e){return r.Browser.retina&&this.options[e+"RetinaUrl"]||this.options[e+"Url"]}});r.icon=function(e){return new r.Icon(e)};r.Icon.Default=r.Icon.extend({options:{iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},_getIconUrl:function(e){var t=e+"Url";if(this.options[t]){return this.options[t]}var n=r.Icon.Default.imagePath;if(!n){throw new Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.")}return n+"/marker-"+e+(r.Browser.retina&&e==="icon"?"-2x":"")+".png"}});r.Icon.Default.imagePath=function(){var e=t.getElementsByTagName("script"),n=/[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/;var r,i,s,o;for(r=0,i=e.length;r<i;r++){s=e[r].src;if(s.match(n)){o=s.split(n)[0];return(o?o+"/":"")+"images"}}}();r.Marker=r.Layer.extend({options:{pane:"markerPane",icon:new r.Icon.Default,clickable:true,keyboard:true,zIndexOffset:0,opacity:1,riseOffset:250},initialize:function(e,t){r.setOptions(this,t);this._latlng=r.latLng(e)},onAdd:function(e){this._zoomAnimated=this._zoomAnimated&&e.options.markerZoomAnimation;this._initIcon();this.update()},onRemove:function(){if(this.dragging){this.dragging.disable()}this._removeIcon();this._removeShadow()},getEvents:function(){var e={viewreset:this.update};if(this._zoomAnimated){e.zoomanim=this._animateZoom}return e},getLatLng:function(){return this._latlng},setLatLng:function(e){var t=this._latlng;this._latlng=r.latLng(e);this.update();return this.fire("move",{oldLatLng:t,latlng:this._latlng})},setZIndexOffset:function(e){this.options.zIndexOffset=e;return this.update()},setIcon:function(e){this.options.icon=e;if(this._map){this._initIcon();this.update()}if(this._popup){this.bindPopup(this._popup)}return this},update:function(){if(this._icon){var e=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(e)}return this},_initIcon:function(){var e=this.options,t="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");var n=e.icon.createIcon(this._icon),i=false;if(n!==this._icon){if(this._icon){this._removeIcon()}i=true;if(e.title){n.title=e.title}if(e.alt){n.alt=e.alt}}r.DomUtil.addClass(n,t);if(e.keyboard){n.tabIndex="0"}this._icon=n;this._initInteraction();if(e.riseOnHover){r.DomEvent.on(n,{mouseover:this._bringToFront,mouseout:this._resetZIndex},this)}var s=e.icon.createShadow(this._shadow),o=false;if(s!==this._shadow){this._removeShadow();o=true}if(s){r.DomUtil.addClass(s,t)}this._shadow=s;if(e.opacity<1){this._updateOpacity()}if(i){this.getPane().appendChild(this._icon)}if(s&&o){this.getPane("shadowPane").appendChild(this._shadow)}},_removeIcon:function(){if(this.options.riseOnHover){r.DomEvent.off(this._icon,{mouseover:this._bringToFront,mouseout:this._resetZIndex},this)}r.DomUtil.remove(this._icon);this._icon=null},_removeShadow:function(){if(this._shadow){r.DomUtil.remove(this._shadow)}this._shadow=null},_setPos:function(e){r.DomUtil.setPosition(this._icon,e);if(this._shadow){r.DomUtil.setPosition(this._shadow,e)}this._zIndex=e.y+this.options.zIndexOffset;this._resetZIndex()},_updateZIndex:function(e){this._icon.style.zIndex=this._zIndex+e},_animateZoom:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center).round();this._setPos(t)},_initInteraction:function(){if(!this.options.clickable){return}r.DomUtil.addClass(this._icon,"leaflet-clickable");r.DomEvent.on(this._icon,"click dblclick mousedown mouseup mouseover mouseout contextmenu keypress",this._fireMouseEvent,this);if(r.Handler.MarkerDrag){this.dragging=new r.Handler.MarkerDrag(this);if(this.options.draggable){this.dragging.enable()}}},_fireMouseEvent:function(e,t){if(e.type==="mousedown"){r.DomEvent.preventDefault(e)}if(e.type==="click"&&this.dragging&&this.dragging.moved()){return}if(e.type==="keypress"&&e.keyCode===13){t="click"}if(this._map){this._map._fireMouseEvent(this,e,t,true,this._latlng)}},setOpacity:function(e){this.options.opacity=e;if(this._map){this._updateOpacity()}return this},_updateOpacity:function(){var e=this.options.opacity;r.DomUtil.setOpacity(this._icon,e);if(this._shadow){r.DomUtil.setOpacity(this._shadow,e)}},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)}});r.marker=function(e,t){return new r.Marker(e,t)};r.DivIcon=r.Icon.extend({options:{iconSize:[12,12],className:"leaflet-div-icon",html:false},createIcon:function(e){var n=e&&e.tagName==="DIV"?e:t.createElement("div"),r=this.options;n.innerHTML=r.html!==false?r.html:"";if(r.bgPos){n.style.backgroundPosition=-r.bgPos.x+"px "+ -r.bgPos.y+"px"}this._setIconStyles(n,"icon");return n},createShadow:function(){return null}});r.divIcon=function(e){return new r.DivIcon(e)};r.Map.mergeOptions({closePopupOnClick:true});r.Popup=r.Layer.extend({options:{pane:"popupPane",minWidth:50,maxWidth:300,offset:[0,7],autoPan:true,autoPanPadding:[5,5],closeButton:true,zoomAnimation:true},initialize:function(e,t){r.setOptions(this,e);this._source=t},onAdd:function(e){this._zoomAnimated=this._zoomAnimated&&this.options.zoomAnimation;if(!this._container){this._initLayout()}if(e._fadeAnimated){r.DomUtil.setOpacity(this._container,0)}clearTimeout(this._removeTimeout);this.getPane().appendChild(this._container);this.update();if(e._fadeAnimated){r.DomUtil.setOpacity(this._container,1)}e.fire("popupopen",{popup:this});if(this._source){this._source.fire("popupopen",{popup:this},true)}},openOn:function(e){e.openPopup(this);return this},onRemove:function(e){if(e._fadeAnimated){r.DomUtil.setOpacity(this._container,0);this._removeTimeout=setTimeout(r.bind(r.DomUtil.remove,r.DomUtil,this._container),200)}else{r.DomUtil.remove(this._container)}e.fire("popupclose",{popup:this});if(this._source){this._source.fire("popupclose",{popup:this},true)}},getLatLng:function(){return this._latlng},setLatLng:function(e){this._latlng=r.latLng(e);if(this._map){this._updatePosition();this._adjustPan()}return this},getContent:function(){return this._content},setContent:function(e){this._content=e;this.update();return this},update:function(){if(!this._map){return}this._container.style.visibility="hidden";this._updateContent();this._updateLayout();this._updatePosition();this._container.style.visibility="";this._adjustPan()},getEvents:function(){var e={viewreset:this._updatePosition},t=this.options;if(this._zoomAnimated){e.zoomanim=this._animateZoom}if("closeOnClick"in t?t.closeOnClick:this._map.options.closePopupOnClick){e.preclick=this._close}if(t.keepInView){e.moveend=this._adjustPan}return e},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},_close:function(){if(this._map){this._map.closePopup(this)}},_initLayout:function(){var e="leaflet-popup",t=this._container=r.DomUtil.create("div",e+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"));if(this.options.closeButton){var n=this._closeButton=r.DomUtil.create("a",e+"-close-button",t);n.href="#close";n.innerHTML="&#215;";r.DomEvent.on(n,"click",this._onCloseButtonClick,this)}var i=this._wrapper=r.DomUtil.create("div",e+"-content-wrapper",t);this._contentNode=r.DomUtil.create("div",e+"-content",i);r.DomEvent.disableClickPropagation(i).disableScrollPropagation(this._contentNode).on(i,"contextmenu",r.DomEvent.stopPropagation);this._tipContainer=r.DomUtil.create("div",e+"-tip-container",t);this._tip=r.DomUtil.create("div",e+"-tip",this._tipContainer)},_updateContent:function(){if(!this._content){return}var e=this._contentNode;if(typeof this._content==="string"){e.innerHTML=this._content}else{while(e.hasChildNodes()){e.removeChild(e.firstChild)}e.appendChild(this._content)}this.fire("contentupdate")},_updateLayout:function(){var e=this._contentNode,t=e.style;t.width="";t.whiteSpace="nowrap";var n=e.offsetWidth;n=Math.min(n,this.options.maxWidth);n=Math.max(n,this.options.minWidth);t.width=n+1+"px";t.whiteSpace="";t.height="";var i=e.offsetHeight,s=this.options.maxHeight,o="leaflet-popup-scrolled";if(s&&i>s){t.height=s+"px";r.DomUtil.addClass(e,o)}else{r.DomUtil.removeClass(e,o)}this._containerWidth=this._container.offsetWidth},_updatePosition:function(){if(!this._map){return}var e=this._map.latLngToLayerPoint(this._latlng),t=r.point(this.options.offset);if(this._zoomAnimated){r.DomUtil.setPosition(this._container,e)}else{t=t.add(e)}var n=this._containerBottom=-t.y,i=this._containerLeft=-Math.round(this._containerWidth/2)+t.x;this._container.style.bottom=n+"px";this._container.style.left=i+"px"},_animateZoom:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center);r.DomUtil.setPosition(this._container,t)},_adjustPan:function(){if(!this.options.autoPan){return}var e=this._map,t=this._container.offsetHeight,n=this._containerWidth,i=new r.Point(this._containerLeft,-t-this._containerBottom);if(this._zoomAnimated){i._add(r.DomUtil.getPosition(this._container))}var s=e.layerPointToContainerPoint(i),o=r.point(this.options.autoPanPadding),u=r.point(this.options.autoPanPaddingTopLeft||o),a=r.point(this.options.autoPanPaddingBottomRight||o),f=e.getSize(),l=0,c=0;if(s.x+n+a.x>f.x){l=s.x+n-f.x+a.x}if(s.x-l-u.x<0){l=s.x-u.x}if(s.y+t+a.y>f.y){c=s.y+t-f.y+a.y}if(s.y-c-u.y<0){c=s.y-u.y}if(l||c){e.fire("autopanstart").panBy([l,c])}},_onCloseButtonClick:function(e){this._close();r.DomEvent.stop(e)}});r.popup=function(e,t){return new r.Popup(e,t)};r.Map.include({openPopup:function(e,t,n){if(!(e instanceof r.Popup)){var i=e;e=(new r.Popup(n)).setContent(i)}if(t){e.setLatLng(t)}if(this.hasLayer(e)){return this}this.closePopup();this._popup=e;return this.addLayer(e)},closePopup:function(e){if(!e||e===this._popup){e=this._popup;this._popup=null}if(e){this.removeLayer(e)}return this}});r.Layer.include({bindPopup:function(e,t){if(e instanceof r.Popup){this._popup=e;e._source=this}else{if(!this._popup||t){this._popup=new r.Popup(t,this)}this._popup.setContent(e)}if(!this._popupHandlersAdded){this.on({click:this._openPopup,remove:this.closePopup,move:this._movePopup});this._popupHandlersAdded=true}return this},unbindPopup:function(){if(this._popup){this.on({click:this._openPopup,remove:this.closePopup,move:this._movePopup});this._popupHandlersAdded=false;this._popup=null}return this},openPopup:function(e){if(this._popup&&this._map){this._map.openPopup(this._popup,e||this._latlng||this.getCenter())}return this},closePopup:function(){if(this._popup){this._popup._close()}return this},togglePopup:function(){if(this._popup){if(this._popup._map){this.closePopup()}else{this.openPopup()}}return this},setPopupContent:function(e){if(this._popup){this._popup.setContent(e)}return this},getPopup:function(){return this._popup},_openPopup:function(e){this._map.openPopup(this._popup,e.latlng)},_movePopup:function(e){this._popup.setLatLng(e.latlng)}});r.Marker.include({bindPopup:function(e,t){var n=r.point(this.options.icon.options.popupAnchor||[0,0]).add(r.Popup.prototype.options.offset);t=r.extend({offset:n},t);return r.Layer.prototype.bindPopup.call(this,e,t)},_openPopup:r.Layer.prototype.togglePopup});r.LayerGroup=r.Layer.extend({initialize:function(e){this._layers={};var t,n;if(e){for(t=0,n=e.length;t<n;t++){this.addLayer(e[t])}}},addLayer:function(e){var t=this.getLayerId(e);this._layers[t]=e;if(this._map){this._map.addLayer(e)}return this},removeLayer:function(e){var t=e in this._layers?e:this.getLayerId(e);if(this._map&&this._layers[t]){this._map.removeLayer(this._layers[t])}delete this._layers[t];return this},hasLayer:function(e){return!!e&&(e in this._layers||this.getLayerId(e)in this._layers)},clearLayers:function(){for(var e in this._layers){this.removeLayer(this._layers[e])}return this},invoke:function(e){var t=Array.prototype.slice.call(arguments,1),n,r;for(n in this._layers){r=this._layers[n];if(r[e]){r[e].apply(r,t)}}return this},onAdd:function(e){for(var t in this._layers){e.addLayer(this._layers[t])}},onRemove:function(e){for(var t in this._layers){e.removeLayer(this._layers[t])}},eachLayer:function(e,t){for(var n in this._layers){e.call(t,this._layers[n])}return this},getLayer:function(e){return this._layers[e]},getLayers:function(){var e=[];for(var t in this._layers){e.push(this._layers[t])}return e},setZIndex:function(e){return this.invoke("setZIndex",e)},getLayerId:function(e){return r.stamp(e)}});r.layerGroup=function(e){return new r.LayerGroup(e)};r.FeatureGroup=r.LayerGroup.extend({addLayer:function(e){if(this.hasLayer(e)){return this}e.addEventParent(this);r.LayerGroup.prototype.addLayer.call(this,e);if(this._popupContent&&e.bindPopup){e.bindPopup(this._popupContent,this._popupOptions)}return this.fire("layeradd",{layer:e})},removeLayer:function(e){if(!this.hasLayer(e)){return this}if(e in this._layers){e=this._layers[e]}e.removeEventParent(this);r.LayerGroup.prototype.removeLayer.call(this,e);if(this._popupContent){this.invoke("unbindPopup")}return this.fire("layerremove",{layer:e})},bindPopup:function(e,t){this._popupContent=e;this._popupOptions=t;return this.invoke("bindPopup",e,t)},openPopup:function(e){for(var t in this._layers){this._layers[t].openPopup(e);break}return this},setStyle:function(e){return this.invoke("setStyle",e)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var e=new r.LatLngBounds;this.eachLayer(function(t){e.extend(t.getBounds?t.getBounds():t.getLatLng())});return e}});r.featureGroup=function(e){return new r.FeatureGroup(e)};r.Renderer=r.Layer.extend({options:{padding:0},initialize:function(e){r.setOptions(this,e);r.stamp(this)},onAdd:function(){if(!this._container){this._initContainer();if(this._zoomAnimated){r.DomUtil.addClass(this._container,"leaflet-zoom-animated")}}this.getPane().appendChild(this._container);this._update()},onRemove:function(){r.DomUtil.remove(this._container)},getEvents:function(){var e={moveend:this._update};if(this._zoomAnimated){e.zoomanim=this._animateZoom}return e},_animateZoom:function(e){var t=e.origin.subtract(this._map._getCenterLayerPoint()),n=this._bounds.min.add(t.multiplyBy(1-e.scale));r.DomUtil.setTransform(this._container,n,e.scale)},_update:function(){var e=this.options.padding,t=this._map.getSize(),n=this._map.containerPointToLayerPoint(t.multiplyBy(-e)).round();this._bounds=new r.Bounds(n,n.add(t.multiplyBy(1+e*2)).round())}});r.Map.include({getRenderer:function(e){var t=e.options.renderer||this.options.renderer||this._renderer;if(!t){t=this._renderer=r.SVG&&r.svg()||r.Canvas&&r.canvas()}if(!this.hasLayer(t)){this.addLayer(t)}return t}});r.Path=r.Layer.extend({options:{stroke:true,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",fillOpacity:.2,clickable:true},onAdd:function(){this._renderer=this._map.getRenderer(this);this._renderer._initPath(this);this._project();this._update();this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},getEvents:function(){return{viewreset:this._project,moveend:this._update}},redraw:function(){if(this._map){this._renderer._updatePath(this)}return this},setStyle:function(e){r.setOptions(this,e);if(this._renderer){this._renderer._updateStyle(this)}return this},bringToFront:function(){this._renderer._bringToFront(this);return this},bringToBack:function(){this._renderer._bringToBack(this);return this},_fireMouseEvent:function(e,t){this._map._fireMouseEvent(this,e,t,true)},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(r.Browser.touch?10:0)}});r.LineUtil={simplify:function(e,t){if(!t||!e.length){return e.slice()}var n=t*t;e=this._reducePoints(e,n);e=this._simplifyDP(e,n);return e},pointToSegmentDistance:function(e,t,n){return Math.sqrt(this._sqClosestPointOnSegment(e,t,n,true))},closestPointOnSegment:function(e,t,n){return this._sqClosestPointOnSegment(e,t,n)},_simplifyDP:function(e,t){var r=e.length,i=typeof Uint8Array!==n+""?Uint8Array:Array,s=new i(r);s[0]=s[r-1]=1;this._simplifyDPStep(e,s,t,0,r-1);var o,u=[];for(o=0;o<r;o++){if(s[o]){u.push(e[o])}}return u},_simplifyDPStep:function(e,t,n,r,i){var s=0,o,u,a;for(u=r+1;u<=i-1;u++){a=this._sqClosestPointOnSegment(e[u],e[r],e[i],true);if(a>s){o=u;s=a}}if(s>n){t[o]=1;this._simplifyDPStep(e,t,n,r,o);this._simplifyDPStep(e,t,n,o,i)}},_reducePoints:function(e,t){var n=[e[0]];for(var r=1,i=0,s=e.length;r<s;r++){if(this._sqDist(e[r],e[i])>t){n.push(e[r]);i=r}}if(i<s-1){n.push(e[s-1])}return n},clipSegment:function(e,t,n,r){var i=r?this._lastCode:this._getBitCode(e,n),s=this._getBitCode(t,n),o,u,a;this._lastCode=s;while(true){if(!(i|s)){return[e,t]}else if(i&s){return false}else{o=i||s;u=this._getEdgeIntersection(e,t,o,n);a=this._getBitCode(u,n);if(o===i){e=u;i=a}else{t=u;s=a}}}},_getEdgeIntersection:function(e,t,n,i){var s=t.x-e.x,o=t.y-e.y,u=i.min,a=i.max,f,l;if(n&8){f=e.x+s*(a.y-e.y)/o;l=a.y}else if(n&4){f=e.x+s*(u.y-e.y)/o;l=u.y}else if(n&2){f=a.x;l=e.y+o*(a.x-e.x)/s}else if(n&1){f=u.x;l=e.y+o*(u.x-e.x)/s}return new r.Point(f,l,true)},_getBitCode:function(e,t){var n=0;if(e.x<t.min.x){n|=1}else if(e.x>t.max.x){n|=2}if(e.y<t.min.y){n|=4}else if(e.y>t.max.y){n|=8}return n},_sqDist:function(e,t){var n=t.x-e.x,r=t.y-e.y;return n*n+r*r},_sqClosestPointOnSegment:function(e,t,n,i){var s=t.x,o=t.y,u=n.x-s,a=n.y-o,f=u*u+a*a,l;if(f>0){l=((e.x-s)*u+(e.y-o)*a)/f;if(l>1){s=n.x;o=n.y}else if(l>0){s+=u*l;o+=a*l}}u=e.x-s;a=e.y-o;return i?u*u+a*a:new r.Point(s,o)}};r.Polyline=r.Path.extend({options:{smoothFactor:1},initialize:function(e,t){r.setOptions(this,t);this._setLatLngs(e)},getLatLngs:function(){return this._latlngs},setLatLngs:function(e){this._setLatLngs(e);return this.redraw()},addLatLng:function(e){e=r.latLng(e);this._latlngs.push(e);this._bounds.extend(e);return this.redraw()},spliceLatLngs:function(){var e=[].splice.apply(this._latlngs,arguments);this._setLatLngs(this._latlngs);this.redraw();return e},closestLayerPoint:function(e){var t=Infinity,n=null,i=r.LineUtil._sqClosestPointOnSegment,s,o;for(var u=0,a=this._parts.length;u<a;u++){var f=this._parts[u];for(var l=1,c=f.length;l<c;l++){s=f[l-1];o=f[l];var h=i(e,s,o,true);if(h<t){t=h;n=i(e,s,o)}}}if(n){n.distance=Math.sqrt(t)}return n},getCenter:function(){var e,t,n,r,i,s,o,u=this._rings[0],a=u.length;for(e=0,t=0;e<a-1;e++){t+=u[e].distanceTo(u[e+1])/2}for(e=0,r=0;e<a-1;e++){i=u[e];s=u[e+1];n=i.distanceTo(s);r+=n;if(r>t){o=(r-t)/n;return this._map.layerPointToLatLng([s.x-o*(s.x-i.x),s.y-o*(s.y-i.y)])}}},getBounds:function(){return this._bounds},_setLatLngs:function(e){this._bounds=new r.LatLngBounds;this._latlngs=this._convertLatLngs(e)},_convertLatLngs:function(e){var t=[],n=this._flat(e);for(var i=0,s=e.length;i<s;i++){if(n){t[i]=r.latLng(e[i]);this._bounds.extend(t[i])}else{t[i]=this._convertLatLngs(e[i])}}return t},_flat:function(e){return!r.Util.isArray(e[0])||typeof e[0][0]!=="object"},_project:function(){this._rings=[];this._projectLatlngs(this._latlngs,this._rings);var e=this._clickTolerance(),t=new r.Point(e,-e);if(this._latlngs.length){this._pxBounds=new r.Bounds(this._map.latLngToLayerPoint(this._bounds.getSouthWest())._subtract(t),this._map.latLngToLayerPoint(this._bounds.getNorthEast())._add(t))}},_projectLatlngs:function(e,t){var n=e[0]instanceof r.LatLng,i=e.length,s,o;if(n){o=[];for(s=0;s<i;s++){o[s]=this._map.latLngToLayerPoint(e[s])}t.push(o)}else{for(s=0;s<i;s++){this._projectLatlngs(e[s],t)}}},_clipPoints:function(){if(this.options.noClip){this._parts=this._rings;return}this._parts=[];var e=this._parts,t=this._renderer._bounds,n,i,s,o,u,a,f;for(n=0,s=0,o=this._rings.length;n<o;n++){f=this._rings[n];for(i=0,u=f.length;i<u-1;i++){a=r.LineUtil.clipSegment(f[i],f[i+1],t,i);if(!a){continue}e[s]=e[s]||[];e[s].push(a[0]);if(a[1]!==f[i+1]||i===u-2){e[s].push(a[1]);s++}}}},_simplifyPoints:function(){var e=this._parts,t=this.options.smoothFactor;for(var n=0,i=e.length;n<i;n++){e[n]=r.LineUtil.simplify(e[n],t)}},_update:function(){if(!this._map){return}this._clipPoints();this._simplifyPoints();this._updatePath()},_updatePath:function(){this._renderer._updatePoly(this)}});r.polyline=function(e,t){return new r.Polyline(e,t)};r.PolyUtil={};r.PolyUtil.clipPolygon=function(e,t){var n,i=[1,4,2,8],s,o,u,a,f,l,c,h,p=r.LineUtil;for(s=0,l=e.length;s<l;s++){e[s]._code=p._getBitCode(e[s],t)}for(u=0;u<4;u++){c=i[u];n=[];for(s=0,l=e.length,o=l-1;s<l;o=s++){a=e[s];f=e[o];if(!(a._code&c)){if(f._code&c){h=p._getEdgeIntersection(f,a,c,t);h._code=p._getBitCode(h,t);n.push(h)}n.push(a)}else if(!(f._code&c)){h=p._getEdgeIntersection(f,a,c,t);h._code=p._getBitCode(h,t);n.push(h)}}e=n}return e};r.Polygon=r.Polyline.extend({options:{fill:true},getCenter:function(){var e,t,n,r,i,s,o,u,a,f=this._rings[0];o=u=a=0;for(e=0,n=f.length,t=n-1;e<n;t=e++){r=f[e];i=f[t];s=r.y*i.x-i.y*r.x;u+=(r.x+i.x)*s;a+=(r.y+i.y)*s;o+=s*3}return this._map.layerPointToLatLng([u/o,a/o])},_convertLatLngs:function(e){var t=r.Polyline.prototype._convertLatLngs.call(this,e),n=t.length;if(n>=2&&t[0]instanceof r.LatLng&&t[0].equals(t[n-1])){t.pop()}return t},_clipPoints:function(){if(this.options.noClip){this._parts=this._rings;return}var e=this._renderer._bounds,t=this.options.weight,n=new r.Point(t,t);e=new r.Bounds(e.min.subtract(n),e.max.add(n));this._parts=[];for(var i=0,s=this._rings.length,o;i<s;i++){o=r.PolyUtil.clipPolygon(this._rings[i],e);if(o.length){this._parts.push(o)}}},_updatePath:function(){this._renderer._updatePoly(this,true)}});r.polygon=function(e,t){return new r.Polygon(e,t)};r.Rectangle=r.Polygon.extend({initialize:function(e,t){r.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(e),t)},setBounds:function(e){this.setLatLngs(this._boundsToLatLngs(e))},_boundsToLatLngs:function(e){e=r.latLngBounds(e);return[e.getSouthWest(),e.getNorthWest(),e.getNorthEast(),e.getSouthEast()]}});r.rectangle=function(e,t){return new r.Rectangle(e,t)};r.CircleMarker=r.Path.extend({options:{fill:true,radius:10},initialize:function(e,t){r.setOptions(this,t);this._latlng=r.latLng(e);this._radius=this.options.radius},setLatLng:function(e){this._latlng=r.latLng(e);this.redraw();return this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(e){this.options.radius=this._radius=e;return this.redraw()},getRadius:function(){return this._radius},setStyle:function(e){var t=e&&e.radius||this._radius;r.Path.prototype.setStyle.call(this,e);this.setRadius(t);return this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng);this._updateBounds()},_updateBounds:function(){var e=this._radius,t=this._radiusY||e,n=this._clickTolerance(),i=[e+n,t+n];this._pxBounds=new r.Bounds(this._point.subtract(i),this._point.add(i))},_update:function(){if(this._map){this._updatePath()}},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)}});r.circleMarker=function(e,t){return new r.CircleMarker(e,t)};r.Circle=r.CircleMarker.extend({initialize:function(e,t,n){r.setOptions(this,n);this._latlng=r.latLng(e);this._mRadius=t},setRadius:function(e){this._mRadius=e;return this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var e=[this._radius,this._radiusY];return new r.LatLngBounds(this._map.layerPointToLatLng(this._point.subtract(e)),this._map.layerPointToLatLng(this._point.add(e)))},setStyle:r.Path.prototype.setStyle,_project:function(){var e=this._latlng.lng,t=this._latlng.lat,n=this._map,i=n.options.crs;if(i.distance===r.CRS.Earth.distance){var s=Math.PI/180,o=this._mRadius/r.CRS.Earth.R/s,u=n.project([t+o,e]),a=n.project([t-o,e]),f=u.add(a).divideBy(2),l=n.unproject(f).lat,c=Math.acos((Math.cos(o*s)-Math.sin(t*s)*Math.sin(l*s))/(Math.cos(t*s)*Math.cos(l*s)))/s;this._point=f.subtract(n.getPixelOrigin());this._radius=isNaN(c)?0:Math.max(Math.round(f.x-n.project([l,e-c]).x),1);this._radiusY=Math.max(Math.round(f.y-u.y),1)}else{var h=i.unproject(i.project(this._latlng).subtract([this._mRadius,0]));this._point=n.latLngToLayerPoint(this._latlng);this._radius=this._point.x-n.latLngToLayerPoint(h).x}this._updateBounds()}});r.circle=function(e,t,n){return new r.Circle(e,t,n)};r.SVG=r.Renderer.extend({_initContainer:function(){this._container=r.SVG.create("svg");this._paths={};this._initEvents();this._container.setAttribute("pointer-events","none")},_update:function(){if(this._map._animatingZoom&&this._bounds){return}r.Renderer.prototype._update.call(this);var e=this._bounds,t=e.getSize(),n=this._container,i=this.getPane();if(r.Browser.mobileWebkit){i.removeChild(n)}r.DomUtil.setPosition(n,e.min);if(!this._svgSize||!this._svgSize.equals(t)){this._svgSize=t;n.setAttribute("width",t.x);n.setAttribute("height",t.y)}r.DomUtil.setPosition(n,e.min);n.setAttribute("viewBox",[e.min.x,e.min.y,t.x,t.y].join(" "));if(r.Browser.mobileWebkit){i.appendChild(n)}},_initPath:function(e){var t=e._path=r.SVG.create("path");if(e.options.className){r.DomUtil.addClass(t,e.options.className)}if(e.options.clickable){r.DomUtil.addClass(t,"leaflet-clickable")}this._updateStyle(e)},_addPath:function(e){var t=e._path;this._container.appendChild(t);this._paths[r.stamp(t)]=e},_removePath:function(e){var t=e._path;r.DomUtil.remove(t);delete this._paths[r.stamp(t)]},_updatePath:function(e){e._project();e._update()},_updateStyle:function(e){var t=e._path,n=e.options;if(!t){return}if(n.stroke){t.setAttribute("stroke",n.color);t.setAttribute("stroke-opacity",n.opacity);t.setAttribute("stroke-width",n.weight);t.setAttribute("stroke-linecap",n.lineCap);t.setAttribute("stroke-linejoin",n.lineJoin);if(n.dashArray){t.setAttribute("stroke-dasharray",n.dashArray)}else{t.removeAttribute("stroke-dasharray")}if(n.dashOffset){t.setAttribute("stroke-dashoffset",n.dashOffset)}else{t.removeAttribute("stroke-dashoffset")}}else{t.setAttribute("stroke","none")}if(n.fill){t.setAttribute("fill",n.fillColor||n.color);t.setAttribute("fill-opacity",n.fillOpacity);t.setAttribute("fill-rule","evenodd")}else{t.setAttribute("fill","none")}t.setAttribute("pointer-events",n.pointerEvents||(n.clickable?"visiblePainted":"none"))},_updatePoly:function(e,t){this._setPath(e,r.SVG.pointsToPath(e._parts,t))},_updateCircle:function(e){var t=e._point,n=e._radius,r=e._radiusY||n,i="a"+n+","+r+" 0 1,0 ";var s=e._empty()?"M0 0":"M"+(t.x-n)+","+t.y+i+n*2+",0 "+i+ -n*2+",0 ";this._setPath(e,s)},_setPath:function(e,t){e._path.setAttribute("d",t)},_bringToFront:function(e){r.DomUtil.toFront(e._path)},_bringToBack:function(e){r.DomUtil.toBack(e._path)},_initEvents:function(){r.DomEvent.on(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu",this._fireMouseEvent,this)},_fireMouseEvent:function(e){var t=this._paths[r.stamp(e.target||e.srcElement)];if(t){t._fireMouseEvent(e)}}});r.extend(r.SVG,{create:function(e){return t.createElementNS("http://www.w3.org/2000/svg",e)},pointsToPath:function(e,t){var n="",i,s,o,u,a,f;for(i=0,o=e.length;i<o;i++){a=e[i];for(s=0,u=a.length;s<u;s++){f=a[s];n+=(s?"L":"M")+f.x+" "+f.y}n+=t?r.Browser.svg?"z":"x":""}return n||"M0 0"}});r.Browser.svg=!!(t.createElementNS&&r.SVG.create("svg").createSVGRect);r.svg=function(e){return r.Browser.svg||r.Browser.vml?new r.SVG(e):null};r.Browser.vml=!r.Browser.svg&&function(){try{var e=t.createElement("div");e.innerHTML='<v:shape adj="1"/>';var n=e.firstChild;n.style.behavior="url(#default#VML)";return n&&typeof n.adj==="object"}catch(r){return false}}();r.SVG.include(!r.Browser.vml?{}:{_initContainer:function(){this._container=r.DomUtil.create("div","leaflet-vml-container");this._paths={};this._initEvents()},_update:function(){if(this._map._animatingZoom){return}r.Renderer.prototype._update.call(this)},_initPath:function(e){var t=e._container=r.SVG.create("shape");r.DomUtil.addClass(t,"leaflet-vml-shape "+(this.options.className||""));t.coordsize="1 1";e._path=r.SVG.create("path");t.appendChild(e._path);this._updateStyle(e)},_addPath:function(e){var t=e._container;this._container.appendChild(t);this._paths[r.stamp(t)]=e},_removePath:function(e){var t=e._container;r.DomUtil.remove(t);delete this._paths[r.stamp(t)]},_updateStyle:function(e){var t=e._stroke,n=e._fill,i=e.options,s=e._container;s.stroked=!!i.stroke;s.filled=!!i.fill;if(i.stroke){if(!t){t=e._stroke=r.SVG.create("stroke");s.appendChild(t)}t.weight=i.weight+"px";t.color=i.color;t.opacity=i.opacity;if(i.dashArray){t.dashStyle=r.Util.isArray(i.dashArray)?i.dashArray.join(" "):i.dashArray.replace(/( *, *)/g," ")}else{t.dashStyle=""}t.endcap=i.lineCap.replace("butt","flat");t.joinstyle=i.lineJoin}else if(t){s.removeChild(t);e._stroke=null}if(i.fill){if(!n){n=e._fill=r.SVG.create("fill");s.appendChild(n)}n.color=i.fillColor||i.color;n.opacity=i.fillOpacity}else if(n){s.removeChild(n);e._fill=null}},_updateCircle:function(e){var t=e._point,n=Math.round(e._radius),r=Math.round(e._radiusY||n);this._setPath(e,e._empty()?"M0 0":"AL "+t.x+","+t.y+" "+n+","+r+" 0,"+65535*360)},_setPath:function(e,t){e._path.v=t}});if(r.Browser.vml){r.SVG.create=function(){try{t.namespaces.add("lvml","urn:schemas-microsoft-com:vml");return function(e){return t.createElement("<lvml:"+e+' class="lvml">')}}catch(e){return function(e){return t.createElement("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}()}r.Canvas=r.Renderer.extend({onAdd:function(){r.Renderer.prototype.onAdd.call(this);this._layers=this._layers||{};this._draw()},_initContainer:function(){var e=this._container=t.createElement("canvas");r.DomEvent.on(e,"mousemove",this._onMouseMove,this).on(e,"click dblclick mousedown mouseup contextmenu",this._onClick,this);this._ctx=e.getContext("2d")},_update:function(){if(this._map._animatingZoom&&this._bounds){return}r.Renderer.prototype._update.call(this);var e=this._bounds,t=this._container,n=e.getSize(),i=r.Browser.retina?2:1;r.DomUtil.setPosition(t,e.min);t.width=i*n.x;t.height=i*n.y;t.style.width=n.x+"px";t.style.height=n.y+"px";if(r.Browser.retina){this._ctx.scale(2,2)}this._ctx.translate(-e.min.x,-e.min.y)},_initPath:function(e){this._layers[r.stamp(e)]=e},_addPath:r.Util.falseFn,_removePath:function(e){e._removed=true;this._requestRedraw(e)},_updatePath:function(e){this._redrawBounds=e._pxBounds;this._draw(true);e._project();e._update();this._draw();this._redrawBounds=null},_updateStyle:function(e){this._requestRedraw(e)},_requestRedraw:function(e){if(!this._map){return}this._redrawBounds=this._redrawBounds||new r.Bounds;this._redrawBounds.extend(e._pxBounds.min).extend(e._pxBounds.max);this._redrawRequest=this._redrawRequest||r.Util.requestAnimFrame(this._redraw,this)},_redraw:function(){this._redrawRequest=null;this._draw(true);this._draw();this._redrawBounds=null},_draw:function(e){this._clear=e;var t;for(var n in this._layers){t=this._layers[n];if(!this._redrawBounds||t._pxBounds.intersects(this._redrawBounds)){t._updatePath()}if(e&&t._removed){delete t._removed;delete this._layers[n]}}},_updatePoly:function(e,t){var n,r,i,s,o=e._parts,u=o.length,a=this._ctx;if(!u){return}a.beginPath();for(n=0;n<u;n++){for(r=0,i=o[n].length;r<i;r++){s=o[n][r];a[r?"lineTo":"moveTo"](s.x,s.y)}if(t){a.closePath()}}this._fillStroke(a,e)},_updateCircle:function(e){if(e._empty()){return}var t=e._point,n=this._ctx,r=e._radius,i=(e._radiusY||r)/r;if(i!==1){n.save();n.scale(1,i)}n.beginPath();n.arc(t.x,t.y/i,r,0,Math.PI*2,false);if(i!==1){n.restore()}this._fillStroke(n,e)},_fillStroke:function(e,t){var n=this._clear,r=t.options;e.globalCompositeOperation=n?"destination-out":"source-over";if(r.fill){e.globalAlpha=n?1:r.fillOpacity;e.fillStyle=r.fillColor||r.color;e.fill("evenodd")}if(r.stroke){e.globalAlpha=n?1:r.opacity;t._prevWeight=e.lineWidth=n?t._prevWeight+1:r.weight;e.strokeStyle=r.color;e.lineCap=r.lineCap;e.lineJoin=r.lineJoin;e.stroke()}},_onClick:function(e){var t=this._map.mouseEventToLayerPoint(e);for(var n in this._layers){if(this._layers[n]._containsPoint(t)){this._layers[n]._fireMouseEvent(e)}}},_onMouseMove:function(e){if(!this._map||this._map._animatingZoom){return}var t=this._map.mouseEventToLayerPoint(e);for(var n in this._layers){this._handleHover(this._layers[n],e,t)}},_handleHover:function(e,t,n){if(!e.options.clickable){return}if(e._containsPoint(n)){if(!e._mouseInside){r.DomUtil.addClass(this._container,"leaflet-clickable");e._fireMouseEvent(t,"mouseover");e._mouseInside=true}e._fireMouseEvent(t)}else if(e._mouseInside){r.DomUtil.removeClass(this._container,"leaflet-clickable");e._fireMouseEvent(t,"mouseout");e._mouseInside=false}},_bringToFront:r.Util.falseFn,_bringToBack:r.Util.falseFn});r.Browser.canvas=function(){return!!t.createElement("canvas").getContext}();r.canvas=function(e){return r.Browser.canvas?new r.Canvas(e):null};r.Polyline.prototype._containsPoint=function(e,t){var n,i,s,o,u,a,f=this._clickTolerance();if(!this._pxBounds.contains(e)){return false}for(n=0,o=this._parts.length;n<o;n++){a=this._parts[n];for(i=0,u=a.length,s=u-1;i<u;s=i++){if(!t&&i===0){continue}if(r.LineUtil.pointToSegmentDistance(e,a[s],a[i])<=f){return true}}}return false};r.Polygon.prototype._containsPoint=function(e){var t=false,n,i,s,o,u,a,f,l;if(!this._pxBounds.contains(e)){return false}for(o=0,f=this._parts.length;o<f;o++){n=this._parts[o];for(u=0,l=n.length,a=l-1;u<l;a=u++){i=n[u];s=n[a];if(i.y>e.y!==s.y>e.y&&e.x<(s.x-i.x)*(e.y-i.y)/(s.y-i.y)+i.x){t=!t}}}return t||r.Polyline.prototype._containsPoint.call(this,e,true)};r.CircleMarker.prototype._containsPoint=function(e){return e.distanceTo(this._point)<=this._radius+this._clickTolerance()};r.GeoJSON=r.FeatureGroup.extend({initialize:function(e,t){r.setOptions(this,t);this._layers={};if(e){this.addData(e)}},addData:function(e){var t=r.Util.isArray(e)?e:e.features,n,i,s;if(t){for(n=0,i=t.length;n<i;n++){s=t[n];if(s.geometries||s.geometry||s.features||s.coordinates){this.addData(s)}}return this}var o=this.options;if(o.filter&&!o.filter(e)){return}var u=r.GeoJSON.geometryToLayer(e,o);u.feature=r.GeoJSON.asFeature(e);u.defaultOptions=u.options;this.resetStyle(u);if(o.onEachFeature){o.onEachFeature(e,u)}return this.addLayer(u)},resetStyle:function(e){e.options=e.defaultOptions;this._setLayerStyle(e,this.options.style);return this},setStyle:function(e){return this.eachLayer(function(t){this._setLayerStyle(t,e)},this)},_setLayerStyle:function(e,t){if(typeof t==="function"){t=t(e.feature)}if(e.setStyle){e.setStyle(t)}}});r.extend(r.GeoJSON,{geometryToLayer:function(e,t){var n=e.type==="Feature"?e.geometry:e,i=n.coordinates,s=[],o=t&&t.pointToLayer,u=t&&t.coordsToLatLng||this.coordsToLatLng,a,f,l,c;switch(n.type){case"Point":a=u(i);return o?o(e,a):new r.Marker(a);case"MultiPoint":for(l=0,c=i.length;l<c;l++){a=u(i[l]);s.push(o?o(e,a):new r.Marker(a))}return new r.FeatureGroup(s);case"LineString":case"MultiLineString":f=this.coordsToLatLngs(i,n.type==="LineString"?0:1,u);return new r.Polyline(f,t);case"Polygon":case"MultiPolygon":f=this.coordsToLatLngs(i,n.type==="Polygon"?1:2,u);return new r.Polygon(f,t);case"GeometryCollection":for(l=0,c=n.geometries.length;l<c;l++){s.push(this.geometryToLayer({geometry:n.geometries[l],type:"Feature",properties:e.properties},t))}return new r.FeatureGroup(s);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(e){return new r.LatLng(e[1],e[0],e[2])},coordsToLatLngs:function(e,t,n){var r=[];for(var i=0,s=e.length,o;i<s;i++){o=t?this.coordsToLatLngs(e[i],t-1,n):(n||this.coordsToLatLng)(e[i]);r.push(o)}return r},latLngToCoords:function(e){return e.alt!==n?[e.lng,e.lat,e.alt]:[e.lng,e.lat]},latLngsToCoords:function(e,t,n){var i=[];for(var s=0,o=e.length;s<o;s++){i.push(t?r.GeoJSON.latLngsToCoords(e[s],t-1,n):r.GeoJSON.latLngToCoords(e[s]))}if(!t&&n){i.push(i[0])}return i},getFeature:function(e,t){return e.feature?r.extend({},e.feature,{geometry:t}):r.GeoJSON.asFeature(t)},asFeature:function(e){if(e.type==="Feature"){return e}return{type:"Feature",properties:{},geometry:e}}});var o={toGeoJSON:function(){return r.GeoJSON.getFeature(this,{type:"Point",coordinates:r.GeoJSON.latLngToCoords(this.getLatLng())})}};r.Marker.include(o);r.Circle.include(o);r.CircleMarker.include(o);r.Polyline.prototype.toGeoJSON=function(){var e=!this._flat(this._latlngs);var t=r.GeoJSON.latLngsToCoords(this._latlngs,e?1:0);return r.GeoJSON.getFeature(this,{type:(e?"Multi":"")+"LineString",coordinates:t})};r.Polygon.prototype.toGeoJSON=function(){var e=!this._flat(this._latlngs),t=e&&!this._flat(this._latlngs[0]);var n=r.GeoJSON.latLngsToCoords(this._latlngs,t?2:e?1:0,true);if(e&&this._latlngs.length===1){t=true;n=[n]}if(!e){n=[n]}return r.GeoJSON.getFeature(this,{type:(t?"Multi":"")+"Polygon",coordinates:n})};r.LayerGroup.include({toMultiPoint:function(){var e=[];this.eachLayer(function(t){e.push(t.toGeoJSON().geometry.coordinates)});return r.GeoJSON.getFeature(this,{type:"MultiPoint",coordinates:e})},toGeoJSON:function(){var e=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(e==="MultiPoint"){return this.toMultiPoint()}var t=e==="GeometryCollection",n=[];this.eachLayer(function(e){if(e.toGeoJSON){var i=e.toGeoJSON();n.push(t?i.geometry:r.GeoJSON.asFeature(i))}});if(t){return r.GeoJSON.getFeature(this,{geometries:n,type:"GeometryCollection"})}return{type:"FeatureCollection",features:n}}});r.geoJson=function(e,t){return new r.GeoJSON(e,t)};var u="_leaflet_events";r.DomEvent={on:function(e,t,n,i){if(typeof t==="object"){for(var s in t){this._on(e,s,t[s],n)}}else{t=r.Util.splitWords(t);for(var o=0,u=t.length;o<u;o++){this._on(e,t[o],n,i)}}return this},off:function(e,t,n,i){if(typeof t==="object"){for(var s in t){this._off(e,s,t[s],n)}}else{t=r.Util.splitWords(t);for(var o=0,u=t.length;o<u;o++){this._off(e,t[o],n,i)}}return this},_on:function(t,n,i,s){var o=n+r.stamp(i)+(s?"_"+r.stamp(s):"");if(t[u]&&t[u][o]){return this}var a=function(n){return i.call(s||t,n||e.event)};var f=a;if(r.Browser.pointer&&n.indexOf("touch")===0){return this.addPointerListener(t,n,a,o)}if(r.Browser.touch&&n==="dblclick"&&this.addDoubleTapListener){this.addDoubleTapListener(t,a,o)}if("addEventListener"in t){if(n==="mousewheel"){t.addEventListener("DOMMouseScroll",a,false);t.addEventListener(n,a,false)}else if(n==="mouseenter"||n==="mouseleave"){a=function(n){n=n||e.event;if(!r.DomEvent._checkMouse(t,n)){return}return f(n)};t.addEventListener(n==="mouseenter"?"mouseover":"mouseout",a,false)}else{if(n==="click"&&r.Browser.android){a=function(e){return r.DomEvent._filterClick(e,f)}}t.addEventListener(n,a,false)}}else if("attachEvent"in t){t.attachEvent("on"+n,a)}t[u]=t[u]||{};t[u][o]=a;return this},_off:function(e,t,n,i){var s=t+r.stamp(n)+(i?"_"+r.stamp(i):""),o=e[u]&&e[u][s];if(!o){return this}if(r.Browser.pointer&&t.indexOf("touch")===0){this.removePointerListener(e,t,s)}else if(r.Browser.touch&&t==="dblclick"&&this.removeDoubleTapListener){this.removeDoubleTapListener(e,s)}else if("removeEventListener"in e){if(t==="mousewheel"){e.removeEventListener("DOMMouseScroll",o,false);e.removeEventListener(t,o,false)}else{e.removeEventListener(t==="mouseenter"?"mouseover":t==="mouseleave"?"mouseout":t,o,false)}}else if("detachEvent"in e){e.detachEvent("on"+t,o)}e[u][s]=null;return this},stopPropagation:function(e){if(e.stopPropagation){e.stopPropagation()}else{e.cancelBubble=true}r.DomEvent._skipped(e);return this},disableScrollPropagation:function(e){return r.DomEvent.on(e,"mousewheel MozMousePixelScroll",r.DomEvent.stopPropagation)},disableClickPropagation:function(e){var t=r.DomEvent.stopPropagation;r.DomEvent.on(e,r.Draggable.START.join(" "),t);return r.DomEvent.on(e,{click:r.DomEvent._fakeStop,dblclick:t})},preventDefault:function(e){if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}return this},stop:function(e){return r.DomEvent.preventDefault(e).stopPropagation(e)},getMousePosition:function(e,t){if(!t){return new r.Point(e.clientX,e.clientY)}var n=t.getBoundingClientRect();return new r.Point(e.clientX-n.left-t.clientLeft,e.clientY-n.top-t.clientTop)},getWheelDelta:function(e){var t=0;if(e.wheelDelta){t=e.wheelDelta/120}if(e.detail){t=-e.detail/3}return t},_skipEvents:{},_fakeStop:function(e){r.DomEvent._skipEvents[e.type]=true},_skipped:function(e){var t=this._skipEvents[e.type];this._skipEvents[e.type]=false;return t},_checkMouse:function(e,t){var n=t.relatedTarget;if(!n){return true}try{while(n&&n!==e){n=n.parentNode}}catch(r){return false}return n!==e},_filterClick:function(e,t){var n=e.timeStamp||e.originalEvent.timeStamp,i=r.DomEvent._lastClick&&n-r.DomEvent._lastClick;if(i&&i>100&&i<500||e.target._simulatedClick&&!e._simulated){r.DomEvent.stop(e);return}r.DomEvent._lastClick=n;return t(e)}};r.DomEvent.addListener=r.DomEvent.on;r.DomEvent.removeListener=r.DomEvent.off;r.Draggable=r.Evented.extend({statics:{START:r.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(e,t){this._element=e;this._dragStartTarget=t||e},enable:function(){if(this._enabled){return}r.DomEvent.on(this._dragStartTarget,r.Draggable.START.join(" "),this._onDown,this);this._enabled=true},disable:function(){if(!this._enabled){return}r.DomEvent.off(this._dragStartTarget,r.Draggable.START.join(" "),this._onDown,this);this._enabled=false;this._moved=false},_onDown:function(e){this._moved=false;if(e.shiftKey||e.which!==1&&e.button!==1&&!e.touches){return}r.DomEvent.stopPropagation(e);if(r.Draggable._disabled){return}r.DomUtil.disableImageDrag();r.DomUtil.disableTextSelection();if(this._moving){return}this.fire("down");var n=e.touches?e.touches[0]:e;this._startPoint=new r.Point(n.clientX,n.clientY);this._startPos=this._newPos=r.DomUtil.getPosition(this._element);r.DomEvent.on(t,r.Draggable.MOVE[e.type],this._onMove,this).on(t,r.Draggable.END[e.type],this._onUp,this)},_onMove:function(e){if(e.touches&&e.touches.length>1){this._moved=true;return}var n=e.touches&&e.touches.length===1?e.touches[0]:e,i=new r.Point(n.clientX,n.clientY),s=i.subtract(this._startPoint);if(!s.x&&!s.y){return}if(r.Browser.touch&&Math.abs(s.x)+Math.abs(s.y)<3){return}r.DomEvent.preventDefault(e);if(!this._moved){this.fire("dragstart");this._moved=true;this._startPos=r.DomUtil.getPosition(this._element).subtract(s);r.DomUtil.addClass(t.body,"leaflet-dragging");this._lastTarget=e.target||e.srcElement;r.DomUtil.addClass(this._lastTarget,"leaflet-drag-target")}this._newPos=this._startPos.add(s);this._moving=true;r.Util.cancelAnimFrame(this._animRequest);this._animRequest=r.Util.requestAnimFrame(this._updatePosition,this,true,this._dragStartTarget)},_updatePosition:function(){this.fire("predrag");r.DomUtil.setPosition(this._element,this._newPos);this.fire("drag")},_onUp:function(){r.DomUtil.removeClass(t.body,"leaflet-dragging");if(this._lastTarget){r.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target");this._lastTarget=null}for(var e in r.Draggable.MOVE){r.DomEvent.off(t,r.Draggable.MOVE[e],this._onMove,this).off(t,r.Draggable.END[e],this._onUp,this)}r.DomUtil.enableImageDrag();r.DomUtil.enableTextSelection();if(this._moved&&this._moving){r.Util.cancelAnimFrame(this._animRequest);this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})}this._moving=false}});r.Handler=r.Class.extend({initialize:function(e){this._map=e},enable:function(){if(this._enabled){return}this._enabled=true;this.addHooks()},disable:function(){if(!this._enabled){return}this._enabled=false;this.removeHooks()},enabled:function(){return!!this._enabled}});r.Map.mergeOptions({dragging:true,inertia:!r.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:Infinity,inertiaThreshold:r.Browser.touch?32:18,easeLinearity:.25,worldCopyJump:false});r.Map.Drag=r.Handler.extend({addHooks:function(){if(!this._draggable){var e=this._map;this._draggable=new r.Draggable(e._mapPane,e._container);this._draggable.on({down:this._onDown,dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this);if(e.options.worldCopyJump){this._draggable.on("predrag",this._onPreDrag,this);e.on("viewreset",this._onViewReset,this);e.whenReady(this._onViewReset,this)}}this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDown:function(){if(this._map._panAnim){this._map._panAnim.stop()}},_onDragStart:function(){var e=this._map;e.fire("movestart").fire("dragstart");if(e.options.inertia){this._positions=[];this._times=[]}},_onDrag:function(){if(this._map.options.inertia){var e=this._lastTime=+(new Date),t=this._lastPos=this._draggable._newPos;this._positions.push(t);this._times.push(e);if(e-this._times[0]>200){this._positions.shift();this._times.shift()}}this._map.fire("move").fire("drag")},_onViewReset:function(){var e=this._map.getSize().divideBy(2),t=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=t.subtract(e).x;this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_onPreDrag:function(){var e=this._worldWidth,t=Math.round(e/2),n=this._initialWorldOffset,r=this._draggable._newPos.x,i=(r-t+n)%e+t-n,s=(r+t+n)%e-t-n,o=Math.abs(i+n)<Math.abs(s+n)?i:s;this._draggable._newPos.x=o},_onDragEnd:function(e){var t=this._map,n=t.options,i=+(new Date)-this._lastTime,s=!n.inertia||i>n.inertiaThreshold||!this._positions[0];t.fire("dragend",e);if(s){t.fire("moveend")}else{var o=this._lastPos.subtract(this._positions[0]),u=(this._lastTime+i-this._times[0])/1e3,a=n.easeLinearity,f=o.multiplyBy(a/u),l=f.distanceTo([0,0]),c=Math.min(n.inertiaMaxSpeed,l),h=f.multiplyBy(c/l),p=c/(n.inertiaDeceleration*a),d=h.multiplyBy(-p/2).round();if(!d.x||!d.y){t.fire("moveend")}else{d=t._limitOffset(d,t.options.maxBounds);r.Util.requestAnimFrame(function(){t.panBy(d,{duration:p,easeLinearity:a,noMoveStart:true})})}}}});r.Map.addInitHook("addHandler","dragging",r.Map.Drag);r.Map.mergeOptions({doubleClickZoom:true});r.Map.DoubleClickZoom=r.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(e){var t=this._map,n=t.getZoom()+(e.originalEvent.shiftKey?-1:1);if(t.options.doubleClickZoom==="center"){t.setZoom(n)}else{t.setZoomAround(e.containerPoint,n)}}});r.Map.addInitHook("addHandler","doubleClickZoom",r.Map.DoubleClickZoom);r.Map.mergeOptions({scrollWheelZoom:true});r.Map.ScrollWheelZoom=r.Handler.extend({addHooks:function(){r.DomEvent.on(this._map._container,{mousewheel:this._onWheelScroll,MozMousePixelScroll:r.DomEvent.preventDefault},this);this._delta=0},removeHooks:function(){r.DomEvent.off(this._map._container,{mousewheel:this._onWheelScroll,MozMousePixelScroll:r.DomEvent.preventDefault},this)},_onWheelScroll:function(e){var t=r.DomEvent.getWheelDelta(e);this._delta+=t;this._lastMousePos=this._map.mouseEventToContainerPoint(e);if(!this._startTime){this._startTime=+(new Date)}var n=Math.max(40-(+(new Date)-this._startTime),0);clearTimeout(this._timer);this._timer=setTimeout(r.bind(this._performZoom,this),n);r.DomEvent.stop(e)},_performZoom:function(){var e=this._map,t=this._delta,n=e.getZoom();t=t>0?Math.ceil(t):Math.floor(t);t=Math.max(Math.min(t,4),-4);t=e._limitZoom(n+t)-n;this._delta=0;this._startTime=null;if(!t){return}if(e.options.scrollWheelZoom==="center"){e.setZoom(n+t)}else{e.setZoomAround(this._lastMousePos,n+t)}}});r.Map.addInitHook("addHandler","scrollWheelZoom",r.Map.ScrollWheelZoom);r.extend(r.DomEvent,{_touchstart:r.Browser.msPointer?"MSPointerDown":r.Browser.pointer?"pointerdown":"touchstart",_touchend:r.Browser.msPointer?"MSPointerUp":r.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(e,n,i){function l(e){var t;if(r.Browser.pointer){f.push(e.pointerId);t=f.length}else{t=e.touches.length}if(t>1){return}var n=Date.now(),i=n-(s||n);o=e.touches?e.touches[0]:e;u=i>0&&i<=a;s=n}function c(e){if(r.Browser.pointer){var t=f.indexOf(e.pointerId);if(t===-1){return}f.splice(t,1)}if(u){if(r.Browser.pointer){var i={},a,l;for(l in o){a=o[l];i[l]=a&&a.bind?a.bind(o):a}o=i}o.type="dblclick";n(o);s=null}}var s,o,u=false,a=250,f=[];var h="_leaflet_",p=this._touchstart,d=this._touchend;e[h+p+i]=l;e[h+d+i]=c;var v=r.Browser.pointer?t.documentElement:e;e.addEventListener(p,l,false);v.addEventListener(d,c,false);if(r.Browser.pointer){v.addEventListener(r.DomEvent.POINTER_CANCEL,c,false)}return this},removeDoubleTapListener:function(e,n){var i="_leaflet_",s=r.Browser.pointer?t.documentElement:e,o=e[i+this._touchend+n];e.removeEventListener(this._touchstart,e[i+this._touchstart+n],false);s.removeEventListener(this._touchend,o,false);if(r.Browser.pointer){s.removeEventListener(r.DomEvent.POINTER_CANCEL,o,false)}return this}});r.extend(r.DomEvent,{POINTER_DOWN:r.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:r.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:r.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:r.Browser.msPointer?"MSPointerCancel":"pointercancel",_pointers:{},addPointerListener:function(e,t,n,r){if(t==="touchstart"){this._addPointerStart(e,n,r)}else if(t==="touchmove"){this._addPointerMove(e,n,r)}else if(t==="touchend"){this._addPointerEnd(e,n,r)}return this},removePointerListener:function(e,t,n){var r=e["_leaflet_"+t+n];if(t==="touchstart"){e.removeEventListener(this.POINTER_DOWN,r,false)}else if(t==="touchmove"){e.removeEventListener(this.POINTER_MOVE,r,false)}else if(t==="touchend"){e.removeEventListener(this.POINTER_UP,r,false);e.removeEventListener(this.POINTER_CANCEL,r,false)}return this},_addPointerStart:function(e,n,i){var s=r.bind(function(e){r.DomEvent.preventDefault(e);this._pointers[e.pointerId]=e;this._handlePointer(e,n)},this);e["_leaflet_touchstart"+i]=s;e.addEventListener(this.POINTER_DOWN,s,false);if(!this._pointerDocListener){var o=r.bind(function(e){delete this._pointers[e.pointerId]},this);t.documentElement.addEventListener(this.POINTER_UP,o,false);t.documentElement.addEventListener(this.POINTER_CANCEL,o,false);this._pointerDocListener=true}},_handlePointer:function(e,t){e.touches=[];for(var n in this._pointers){e.touches.push(this._pointers[n])}e.changedTouches=[e];t(e)},_addPointerMove:function(e,t,n){var i=r.bind(function(e){if((e.pointerType===e.MSPOINTER_TYPE_MOUSE||e.pointerType==="mouse")&&e.buttons===0){return}this._pointers[e.pointerId]=e;this._handlePointer(e,t)},this);e["_leaflet_touchmove"+n]=i;e.addEventListener(this.POINTER_MOVE,i,false)},_addPointerEnd:function(e,t,n){var i=r.bind(function(e){delete this._pointers[e.pointerId];this._handlePointer(e,t)},this);e["_leaflet_touchend"+n]=i;e.addEventListener(this.POINTER_UP,i,false);e.addEventListener(this.POINTER_CANCEL,i,false)}});r.Map.mergeOptions({touchZoom:r.Browser.touch&&!r.Browser.android23,bounceAtZoomLimits:true});r.Map.TouchZoom=r.Handler.extend({addHooks:function(){r.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){r.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(e){var n=this._map;if(!e.touches||e.touches.length!==2||n._animatingZoom||this._zooming){return}var i=n.mouseEventToLayerPoint(e.touches[0]),s=n.mouseEventToLayerPoint(e.touches[1]),o=n._getCenterLayerPoint();this._startCenter=i.add(s)._divideBy(2);this._startDist=i.distanceTo(s);this._moved=false;this._zooming=true;this._centerOffset=o.subtract(this._startCenter);if(n._panAnim){n._panAnim.stop()}r.DomEvent.on(t,"touchmove",this._onTouchMove,this).on(t,"touchend",this._onTouchEnd,this);r.DomEvent.preventDefault(e)},_onTouchMove:function(e){if(!e.touches||e.touches.length!==2||!this._zooming){return}var t=this._map,n=t.mouseEventToLayerPoint(e.touches[0]),i=t.mouseEventToLayerPoint(e.touches[1]);this._scale=n.distanceTo(i)/this._startDist;this._delta=n._add(i)._divideBy(2)._subtract(this._startCenter);if(!t.options.bounceAtZoomLimits&&(t.getZoom()===t.getMinZoom()&&this._scale<1||t.getZoom()===t.getMaxZoom()&&this._scale>1)){return}if(!this._moved){t.fire("movestart").fire("zoomstart");this._moved=true}r.Util.cancelAnimFrame(this._animRequest);this._animRequest=r.Util.requestAnimFrame(this._updateOnMove,this,true,this._map._container);r.DomEvent.preventDefault(e)},_updateOnMove:function(){var e=this._map;if(e.options.touchZoom==="center"){this._center=e.getCenter()}else{this._center=e.layerPointToLatLng(this._getTargetCenter())}this._zoom=e.getScaleZoom(this._scale);e._animateZoom(this._center,this._zoom)},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=false;return}this._zooming=false;r.Util.cancelAnimFrame(this._animRequest);r.DomEvent.off(t,"touchmove",this._onTouchMove).off(t,"touchend",this._onTouchEnd);var e=this._map,n=e.getZoom(),i=this._zoom-n,s=e._limitZoom(n+(i>0?Math.ceil(i):Math.floor(i)));e._animateZoom(this._center,s,true)},_getTargetCenter:function(){var e=this._centerOffset.subtract(this._delta).divideBy(this._scale);return this._startCenter.add(e)}});r.Map.addInitHook("addHandler","touchZoom",r.Map.TouchZoom);r.Map.mergeOptions({tap:true,tapTolerance:15});r.Map.Tap=r.Handler.extend({addHooks:function(){r.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){r.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(e){if(!e.touches){return}r.DomEvent.preventDefault(e);this._fireClick=true;if(e.touches.length>1){this._fireClick=false;clearTimeout(this._holdTimeout);return}var n=e.touches[0],i=n.target;this._startPos=this._newPos=new r.Point(n.clientX,n.clientY);if(i.tagName&&i.tagName.toLowerCase()==="a"){r.DomUtil.addClass(i,"leaflet-active")}this._holdTimeout=setTimeout(r.bind(function(){if(this._isTapValid()){this._fireClick=false;this._onUp();this._simulateEvent("contextmenu",n)}},this),1e3);this._simulateEvent("mousedown",n);r.DomEvent.on(t,{touchmove:this._onMove,touchend:this._onUp},this)},_onUp:function(e){clearTimeout(this._holdTimeout);r.DomEvent.off(t,{touchmove:this._onMove,touchend:this._onUp},this);if(this._fireClick&&e&&e.changedTouches){var n=e.changedTouches[0],i=n.target;if(i&&i.tagName&&i.tagName.toLowerCase()==="a"){r.DomUtil.removeClass(i,"leaflet-active")}this._simulateEvent("mouseup",n);if(this._isTapValid()){this._simulateEvent("click",n)}}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(e){var t=e.touches[0];this._newPos=new r.Point(t.clientX,t.clientY)},_simulateEvent:function(n,r){var i=t.createEvent("MouseEvents");i._simulated=true;r.target._simulatedClick=true;i.initMouseEvent(n,true,true,e,1,r.screenX,r.screenY,r.clientX,r.clientY,false,false,false,false,0,null);r.target.dispatchEvent(i)}});if(r.Browser.touch&&!r.Browser.pointer){r.Map.addInitHook("addHandler","tap",r.Map.Tap)}r.Map.mergeOptions({boxZoom:true});r.Map.BoxZoom=r.Handler.extend({initialize:function(e){this._map=e;this._container=e._container;this._pane=e._panes.overlayPane},addHooks:function(){r.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){r.DomEvent.off(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_onMouseDown:function(e){if(!e.shiftKey||e.which!==1&&e.button!==1){return false}this._moved=false;r.DomUtil.disableTextSelection();r.DomUtil.disableImageDrag();this._startPoint=this._map.mouseEventToContainerPoint(e);r.DomEvent.on(t,{contextmenu:r.DomEvent.stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(e){if(!this._moved){this._moved=true;this._box=r.DomUtil.create("div","leaflet-zoom-box",this._container);r.DomUtil.addClass(this._container,"leaflet-crosshair");this._map.fire("boxzoomstart")}this._point=this._map.mouseEventToContainerPoint(e);var t=new r.Bounds(this._point,this._startPoint),n=t.getSize();r.DomUtil.setPosition(this._box,t.min);this._box.style.width=n.x+"px";this._box.style.height=n.y+"px"},_finish:function(){if(this._moved){r.DomUtil.remove(this._box);r.DomUtil.removeClass(this._container,"leaflet-crosshair")}r.DomUtil.enableTextSelection();r.DomUtil.enableImageDrag();r.DomEvent.off(t,{contextmenu:r.DomEvent.stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(e){if(e.which!==1&&e.button!==1){return false}this._finish();if(!this._moved){return}var t=new r.LatLngBounds(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(t).fire("boxzoomend",{boxZoomBounds:t})},_onKeyDown:function(e){if(e.keyCode===27){this._finish()}}});r.Map.addInitHook("addHandler","boxZoom",r.Map.BoxZoom);r.Map.mergeOptions({keyboard:true,keyboardPanOffset:80,keyboardZoomOffset:1});r.Map.Keyboard=r.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,173]},initialize:function(e){this._map=e;this._setPanOffset(e.options.keyboardPanOffset);this._setZoomOffset(e.options.keyboardZoomOffset)},addHooks:function(){var e=this._map._container;if(e.tabIndex===-1){e.tabIndex="0"}r.DomEvent.on(e,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this);this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks();r.DomEvent.off(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this);this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(this._focused){return}var n=t.body,r=t.documentElement,i=n.scrollTop||r.scrollTop,s=n.scrollLeft||r.scrollLeft;this._map._container.focus();e.scrollTo(s,i)},_onFocus:function(){this._focused=true;this._map.fire("focus")},_onBlur:function(){this._focused=false;this._map.fire("blur")},_setPanOffset:function(e){var t=this._panKeys={},n=this.keyCodes,r,i;for(r=0,i=n.left.length;r<i;r++){t[n.left[r]]=[-1*e,0]}for(r=0,i=n.right.length;r<i;r++){t[n.right[r]]=[e,0]}for(r=0,i=n.down.length;r<i;r++){t[n.down[r]]=[0,e]}for(r=0,i=n.up.length;r<i;r++){t[n.up[r]]=[0,-1*e]}},_setZoomOffset:function(e){var t=this._zoomKeys={},n=this.keyCodes,r,i;for(r=0,i=n.zoomIn.length;r<i;r++){t[n.zoomIn[r]]=e}for(r=0,i=n.zoomOut.length;r<i;r++){t[n.zoomOut[r]]=-e}},_addHooks:function(){r.DomEvent.on(t,"keydown",this._onKeyDown,this)},_removeHooks:function(){r.DomEvent.off(t,"keydown",this._onKeyDown,this)},_onKeyDown:function(e){if(e.altKey||e.ctrlKey||e.metaKey){return}var t=e.keyCode,n=this._map;if(t in this._panKeys){if(n._panAnim&&n._panAnim._inProgress){return}n.panBy(this._panKeys[t]);if(n.options.maxBounds){n.panInsideBounds(n.options.maxBounds)}}else if(t in this._zoomKeys){n.setZoom(n.getZoom()+this._zoomKeys[t])}else{return}r.DomEvent.stop(e)}});r.Map.addInitHook("addHandler","keyboard",r.Map.Keyboard);r.Handler.MarkerDrag=r.Handler.extend({initialize:function(e){this._marker=e},addHooks:function(){var e=this._marker._icon;if(!this._draggable){this._draggable=new r.Draggable(e,e)}this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).enable();r.DomUtil.addClass(e,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).disable();r.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(){var e=this._marker,t=e._shadow,n=r.DomUtil.getPosition(e._icon),i=e._map.layerPointToLatLng(n);if(t){r.DomUtil.setPosition(t,n)}e._latlng=i;e.fire("move",{latlng:i}).fire("drag")},_onDragEnd:function(e){this._marker.fire("moveend").fire("dragend",e)}});r.Control=r.Class.extend({options:{position:"topright"},initialize:function(e){r.setOptions(this,e)},getPosition:function(){return this.options.position},setPosition:function(e){var t=this._map;if(t){t.removeControl(this)}this.options.position=e;if(t){t.addControl(this)}return this},getContainer:function(){return this._container},addTo:function(e){this._map=e;var t=this._container=this.onAdd(e),n=this.getPosition(),i=e._controlCorners[n];r.DomUtil.addClass(t,"leaflet-control");if(n.indexOf("bottom")!==-1){i.insertBefore(t,i.firstChild)}else{i.appendChild(t)}return this},remove:function(){r.DomUtil.remove(this._container);if(this.onRemove){this.onRemove(this._map)}this._map=null;return this},_refocusOnMap:function(){if(this._map){this._map.getContainer().focus()}}});r.control=function(e){return new r.Control(e)};r.Map.include({addControl:function(e){e.addTo(this);return this},removeControl:function(e){e.remove();return this},_initControlPos:function(){function i(i,s){var o=t+i+" "+t+s;e[i+s]=r.DomUtil.create("div",o,n)}var e=this._controlCorners={},t="leaflet-",n=this._controlContainer=r.DomUtil.create("div",t+"control-container",this._container);i("top","left");i("top","right");i("bottom","left");i("bottom","right")},_clearControlPos:function(){r.DomUtil.remove(this._controlContainer)}});r.Control.Zoom=r.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(e){var t="leaflet-control-zoom",n=r.DomUtil.create("div",t+" leaflet-bar"),i=this.options;this._zoomInButton=this._createButton(i.zoomInText,i.zoomInTitle,t+"-in",n,this._zoomIn);this._zoomOutButton=this._createButton(i.zoomOutText,i.zoomOutTitle,t+"-out",n,this._zoomOut);this._updateDisabled();e.on("zoomend zoomlevelschange",this._updateDisabled,this);return n},onRemove:function(e){e.off("zoomend zoomlevelschange",this._updateDisabled,this)},_zoomIn:function(e){this._map.zoomIn(e.shiftKey?3:1)},_zoomOut:function(e){this._map.zoomOut(e.shiftKey?3:1)},_createButton:function(e,t,n,i,s){var o=r.DomUtil.create("a",n,i);o.innerHTML=e;o.href="#";o.title=t;r.DomEvent.on(o,"mousedown dblclick",r.DomEvent.stopPropagation).on(o,"click",r.DomEvent.stop).on(o,"click",s,this).on(o,"click",this._refocusOnMap,this);return o},_updateDisabled:function(){var e=this._map,t="leaflet-disabled";r.DomUtil.removeClass(this._zoomInButton,t);r.DomUtil.removeClass(this._zoomOutButton,t);if(e._zoom===e.getMinZoom()){r.DomUtil.addClass(this._zoomOutButton,t)}if(e._zoom===e.getMaxZoom()){r.DomUtil.addClass(this._zoomInButton,t)}}});r.Map.mergeOptions({zoomControl:true});r.Map.addInitHook(function(){if(this.options.zoomControl){this.zoomControl=new r.Control.Zoom;this.addControl(this.zoomControl)}});r.control.zoom=function(e){return new r.Control.Zoom(e)};r.Control.Attribution=r.Control.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(e){r.setOptions(this,e);this._attributions={}},onAdd:function(e){this._container=r.DomUtil.create("div","leaflet-control-attribution");r.DomEvent.disableClickPropagation(this._container);for(var t in e._layers){if(e._layers[t].getAttribution){this.addAttribution(e._layers[t].getAttribution())}}this._update();return this._container},setPrefix:function(e){this.options.prefix=e;this._update();return this},addAttribution:function(e){if(!e){return}if(!this._attributions[e]){this._attributions[e]=0}this._attributions[e]++;this._update();return this},removeAttribution:function(e){if(!e){return}if(this._attributions[e]){this._attributions[e]--;this._update()}return this},_update:function(){if(!this._map){return}var e=[];for(var t in this._attributions){if(this._attributions[t]){e.push(t)}}var n=[];if(this.options.prefix){n.push(this.options.prefix)}if(e.length){n.push(e.join(", "))}this._container.innerHTML=n.join(" | ")}});r.Map.mergeOptions({attributionControl:true});r.Map.addInitHook(function(){if(this.options.attributionControl){this.attributionControl=(new r.Control.Attribution).addTo(this)}});r.control.attribution=function(e){return new r.Control.Attribution(e)};r.Control.Scale=r.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:true,imperial:true},onAdd:function(e){var t="leaflet-control-scale",n=r.DomUtil.create("div",t),i=this.options;this._addScales(i,t+"-line",n);e.on(i.updateWhenIdle?"moveend":"move",this._update,this);e.whenReady(this._update,this);return n},onRemove:function(e){e.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(e,t,n){if(e.metric){this._mScale=r.DomUtil.create("div",t,n)}if(e.imperial){this._iScale=r.DomUtil.create("div",t,n)}},_update:function(){var e=this._map,t=e.getSize().y/2;var n=r.CRS.Earth.distance(e.containerPointToLatLng([0,t]),e.containerPointToLatLng([this.options.maxWidth,t]));this._updateScales(n)},_updateScales:function(e){if(this.options.metric&&e){this._updateMetric(e)}if(this.options.imperial&&e){this._updateImperial(e)}},_updateMetric:function(e){var t=this._getRoundNum(e),n=t<1e3?t+" m":t/1e3+" km";this._updateScale(this._mScale,n,t/e)},_updateImperial:function(e){var t=e*3.2808399,n,r,i;if(t>5280){n=t/5280;r=this._getRoundNum(n);this._updateScale(this._iScale,r+" mi",r/n)}else{i=this._getRoundNum(t);this._updateScale(this._iScale,i+" ft",i/t)}},_updateScale:function(e,t,n){e.style.width=Math.round(this.options.maxWidth*n)-10+"px";e.innerHTML=t},_getRoundNum:function(e){var t=Math.pow(10,(Math.floor(e)+"").length-1),n=e/t;n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:1;return t*n}});r.control.scale=function(e){return new r.Control.Scale(e)};r.Control.Layers=r.Control.extend({options:{collapsed:true,position:"topright",autoZIndex:true},initialize:function(e,t,n){r.setOptions(this,n);this._layers={};this._lastZIndex=0;this._handlingClick=false;for(var i in e){this._addLayer(e[i],i)}for(i in t){this._addLayer(t[i],i,true)}},onAdd:function(){this._initLayout();this._update();return this._container},addBaseLayer:function(e,t){this._addLayer(e,t);return this._update()},addOverlay:function(e,t){this._addLayer(e,t,true);return this._update()},removeLayer:function(e){e.off("add remove",this._onLayerChange,this);delete this._layers[r.stamp(e)];return this._update()},_initLayout:function(){var e="leaflet-control-layers",t=this._container=r.DomUtil.create("div",e);t.setAttribute("aria-haspopup",true);if(!r.Browser.touch){r.DomEvent.disableClickPropagation(t).disableScrollPropagation(t)}else{r.DomEvent.on(t,"click",r.DomEvent.stopPropagation)}var n=this._form=r.DomUtil.create("form",e+"-list");if(this.options.collapsed){if(!r.Browser.android){r.DomEvent.on(t,{mouseenter:this._expand,mouseleave:this._collapse},this)}var i=this._layersLink=r.DomUtil.create("a",e+"-toggle",t);i.href="#";i.title="Layers";if(r.Browser.touch){r.DomEvent.on(i,"click",r.DomEvent.stop).on(i,"click",this._expand,this)}else{r.DomEvent.on(i,"focus",this._expand,this)}r.DomEvent.on(n,"click",function(){setTimeout(r.bind(this._onInputClick,this),0)},this);this._map.on("click",this._collapse,this)}else{this._expand()}this._baseLayersList=r.DomUtil.create("div",e+"-base",n);this._separator=r.DomUtil.create("div",e+"-separator",n);this._overlaysList=r.DomUtil.create("div",e+"-overlays",n);t.appendChild(n)},_addLayer:function(e,t,n){e.on("add remove",this._onLayerChange,this);var i=r.stamp(e);this._layers[i]={layer:e,name:t,overlay:n};if(this.options.autoZIndex&&e.setZIndex){this._lastZIndex++;e.setZIndex(this._lastZIndex)}},_update:function(){if(!this._container){return}r.DomUtil.empty(this._baseLayersList);r.DomUtil.empty(this._overlaysList);var e,t,n,i;for(n in this._layers){i=this._layers[n];this._addItem(i);t=t||i.overlay;e=e||!i.overlay}this._separator.style.display=t&&e?"":"none";return this},_onLayerChange:function(e){if(!this._handlingClick){this._update()}var t=this._layers[r.stamp(e.target)].overlay;var n=t?e.type==="add"?"overlayadd":"overlayremove":e.type==="add"?"baselayerchange":null;if(n){this._map.fire(n,e.target)}},_createRadioElement:function(e,n){var r='<input type="radio" class="leaflet-control-layers-selector" name="'+e+'"'+(n?' checked="checked"':"")+"/>";var i=t.createElement("div");i.innerHTML=r;return i.firstChild},_addItem:function(e){var n=t.createElement("label"),i=this._map.hasLayer(e.layer),s;if(e.overlay){s=t.createElement("input");s.type="checkbox";s.className="leaflet-control-layers-selector";s.defaultChecked=i}else{s=this._createRadioElement("leaflet-base-layers",i)}s.layerId=r.stamp(e.layer);r.DomEvent.on(s,"click",this._onInputClick,this);var o=t.createElement("span");o.innerHTML=" "+e.name;n.appendChild(s);n.appendChild(o);var u=e.overlay?this._overlaysList:this._baseLayersList;u.appendChild(n);return n},_onInputClick:function(){var e=this._form.getElementsByTagName("input"),t,n,r;this._handlingClick=true;for(var i=0,s=e.length;i<s;i++){t=e[i];n=this._layers[t.layerId].layer;r=this._map.hasLayer(n);if(t.checked&&!r){this._map.addLayer(n)}else if(!t.checked&&r){this._map.removeLayer(n)}}this._handlingClick=false;this._refocusOnMap()},_expand:function(){r.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){r.DomUtil.removeClass(this._container,"leaflet-control-layers-expanded")}});r.control.layers=function(e,t,n){return new r.Control.Layers(e,t,n)};r.PosAnimation=r.Evented.extend({run:function(e,t,n,i){this.stop();this._el=e;this._inProgress=true;this._newPos=t;this.fire("start");e.style[r.DomUtil.TRANSITION]="all "+(n||.25)+"s cubic-bezier(0,0,"+(i||.5)+",1)";r.DomEvent.on(e,r.DomUtil.TRANSITION_END,this._onTransitionEnd,this);r.DomUtil.setPosition(e,t);r.Util.falseFn(e.offsetWidth);this._stepTimer=setInterval(r.bind(this._onStep,this),50)},stop:function(){if(!this._inProgress){return}this._newPos=this._getPos();if(this._newPos){r.DomUtil.setPosition(this._el,this._newPos)}this._onTransitionEnd();r.Util.falseFn(this._el.offsetWidth)},_onStep:function(){var e=this._getPos();if(!e){this._onTransitionEnd();return}this._el._leaflet_pos=e;this.fire("step")},_transformRe:/([-+]?(?:\d*\.)?\d+)\D*, ([-+]?(?:\d*\.)?\d+)\D*\)/,_getPos:function(){var t,n,i,s=this._el,o=e.getComputedStyle(s);if(r.Browser.any3d){i=o[r.DomUtil.TRANSFORM].match(this._transformRe);if(!i){return}t=parseFloat(i[1]);n=parseFloat(i[2])}else{t=parseFloat(o.left);n=parseFloat(o.top)}return new r.Point(t,n,true)},_onTransitionEnd:function(){r.DomEvent.off(this._el,r.DomUtil.TRANSITION_END,this._onTransitionEnd,this);if(!this._inProgress){return}this._inProgress=false;this._el.style[r.DomUtil.TRANSITION]="";this._el._leaflet_pos=this._newPos;clearInterval(this._stepTimer);this.fire("step").fire("end")}});r.Map.include({setView:function(e,t,i){t=t===n?this._zoom:this._limitZoom(t);e=this._limitCenter(r.latLng(e),t,this.options.maxBounds);i=i||{};if(this._panAnim){this._panAnim.stop()}if(this._loaded&&!i.reset&&i!==true){if(i.animate!==n){i.zoom=r.extend({animate:i.animate},i.zoom);i.pan=r.extend({animate:i.animate},i.pan)}var s=this._zoom!==t?this._tryAnimatedZoom&&this._tryAnimatedZoom(e,t,i.zoom):this._tryAnimatedPan(e,i.pan);if(s){clearTimeout(this._sizeTimer);return this}}this._resetView(e,t);return this},panBy:function(e,t){e=r.point(e).round();t=t||{};if(!e.x&&!e.y){return this}if(t.animate!==true&&!this.getSize().contains(e)){return this._resetView(this.unproject(this.project(this.getCenter()).add(e)),this.getZoom())}if(!this._panAnim){this._panAnim=new r.PosAnimation;this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)}if(!t.noMoveStart){this.fire("movestart")}if(t.animate!==false){r.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var n=this._getMapPanePos().subtract(e);this._panAnim.run(this._mapPane,n,t.duration||.25,t.easeLinearity)}else{this._rawPanBy(e);this.fire("move").fire("moveend")}return this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){r.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim");this.fire("moveend")},_tryAnimatedPan:function(e,t){var n=this._getCenterOffset(e)._floor();if((t&&t.animate)!==true&&!this.getSize().contains(n)){return false}this.panBy(n,t);return true}});r.PosAnimation=r.DomUtil.TRANSITION?r.PosAnimation:r.PosAnimation.extend({run:function(e,t,n,i){this.stop();this._el=e;this._inProgress=true;this._duration=n||.25;this._easeOutPower=1/Math.max(i||.5,.2);this._startPos=r.DomUtil.getPosition(e);this._offset=t.subtract(this._startPos);this._startTime=+(new Date);this.fire("start");this._animate()},stop:function(){if(!this._inProgress){return}this._step();this._complete()},_animate:function(){this._animId=r.Util.requestAnimFrame(this._animate,this);this._step()},_step:function(){var e=+(new Date)-this._startTime,t=this._duration*1e3;if(e<t){this._runFrame(this._easeOut(e/t))}else{this._runFrame(1);this._complete()}},_runFrame:function(e){var t=this._startPos.add(this._offset.multiplyBy(e));r.DomUtil.setPosition(this._el,t);this.fire("step")},_complete:function(){r.Util.cancelAnimFrame(this._animId);this._inProgress=false;this.fire("end")},_easeOut:function(e){return 1-Math.pow(1-e,this._easeOutPower)}});r.Map.mergeOptions({zoomAnimation:true,zoomAnimationThreshold:4});var a=r.DomUtil.TRANSITION&&r.Browser.any3d&&!r.Browser.mobileOpera;if(a){r.Map.addInitHook(function(){this._zoomAnimated=this.options.zoomAnimation;if(this._zoomAnimated){r.DomEvent.on(this._mapPane,r.DomUtil.TRANSITION_END,this._catchTransitionEnd,this)}})}r.Map.include(!a?{}:{_catchTransitionEnd:function(e){if(this._animatingZoom&&e.propertyName.indexOf("transform")>=0){this._onZoomTransitionEnd()}},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(e,t,n){if(this._animatingZoom){return true}n=n||{};if(!this._zoomAnimated||n.animate===false||this._nothingToAnimate()||Math.abs(t-this._zoom)>this.options.zoomAnimationThreshold){return false}var i=this.getZoomScale(t),s=this._getCenterOffset(e)._divideBy(1-1/i);if(n.animate!==true&&!this.getSize().contains(s)){return false}r.Util.requestAnimFrame(function(){this.fire("movestart").fire("zoomstart")._animateZoom(e,t,true)},this);return true},_animateZoom:function(e,t,n){if(n){this._animatingZoom=true;this._animateToCenter=e;this._animateToZoom=t;if(r.Draggable){r.Draggable._disabled=true}r.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim")}var i=this.getZoomScale(t),s=this._getCenterLayerPoint().add(this._getCenterOffset(e)._divideBy(1-1/i));this.fire("zoomanim",{center:e,zoom:t,origin:s,scale:i})},_onZoomTransitionEnd:function(){this._animatingZoom=false;r.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim");this._resetView(this._animateToCenter,this._animateToZoom,true,true);if(r.Draggable){r.Draggable._disabled=false}}});r.Map.include({_defaultLocateOptions:{timeout:1e4,watch:false},locate:function(e){e=this._locateOptions=r.extend(this._defaultLocateOptions,e);if(!navigator.geolocation){this._handleGeolocationError({code:0,message:"Geolocation not supported."});return this}var t=r.bind(this._handleGeolocationResponse,this),n=r.bind(this._handleGeolocationError,this);if(e.watch){this._locationWatchId=navigator.geolocation.watchPosition(t,n,e)}else{navigator.geolocation.getCurrentPosition(t,n,e)}return this},stopLocate:function(){if(navigator.geolocation){navigator.geolocation.clearWatch(this._locationWatchId)}if(this._locateOptions){this._locateOptions.setView=false}return this},_handleGeolocationError:function(e){var t=e.code,n=e.message||(t===1?"permission denied":t===2?"position unavailable":"timeout");if(this._locateOptions.setView&&!this._loaded){this.fitWorld()}this.fire("locationerror",{code:t,message:"Geolocation error: "+n+"."})},_handleGeolocationResponse:function(e){var t=e.coords.latitude,n=e.coords.longitude,i=new r.LatLng(t,n),s=180*e.coords.accuracy/40075017,o=s/Math.cos(Math.PI/180*t),u=r.latLngBounds([t-s,n-o],[t+s,n+o]),a=this._locateOptions;if(a.setView){var f=this.getBoundsZoom(u);this.setView(i,a.maxZoom?Math.min(f,a.maxZoom):f)}var l={latlng:i,bounds:u,timestamp:e.timestamp};for(var c in e.coords){if(typeof e.coords[c]==="number"){l[c]=e.coords[c]}}this.fire("locationfound",l)}})})(window,document)